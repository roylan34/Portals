<!-- Modal -->
  <div class="modal fade" id="modalFormCurrentMrf" data-backdrop="static" data-keyboard="true" tabindex="-1" role="dialog" aria-labelledby="modalFormCurrentMrf">
    <div class="modal-dialog" role="document" style="width:auto; max-width: 950px">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"></h4>
        </div>

        <div class="modal-body">
                <form id="frmCurrentMrf" class="form-horizontal">
                	<input type="hidden" name="hdnIdCurrentMrf" id="hdnIdCurrentMrf">
                  <input type="hidden" name="hdnAttachmentName" class="hdnAttachmentName">

            	  <!--<ul class="text-center list-inline main-link-navigation">
            	     	<li class="link-navigation">Step 1</li>
            	     	<li class="link-navigation">Step 2</li>
            	     	<li class="link-navigation">Step 3</li>
            	     </ul> -->

                    <ol class="main-link-navigation cd-multi-steps text-bottom count">
                      <li class="link-navigation"><a href="#">For Delivery</a></li>
                      <li class="link-navigation" ><a href="#">Return/Pull-out</a></li>
                      <li class="link-navigation"><a href="#">Customer Details</a></li>
                    </ol>


                   <div class="pull-right form-no" style="border:#000 1px solid; padding: 3px; margin-bottom: 10px"><strong>FORM NO: </strong><span id="form-code"></span></div>
        			
                    <div class="col-md-12 form-section form-component-1">
                      <!-- <h4>Step 1</h4> -->
                      <div class="form-group">
                        <p class="col-sm-12"><em>Place indicate the machines for delivery:</em></p>
                        <div class="mrf-table-responsive" style="overflow: unset;">
                           <table id="tbl_frm_component_1" class="table">
                              <thead>
                                <tr>
                                  <th>Quantity</th>
                                  <th>Brand</th>
                                  <th>Model</th> 
                                  <th>BN/RF</th>                                 
                                  <th>Remarks</th>
                                  <th>S/N</th>
                                  <th>Toner</th>
                                  <th></th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr class="not-tr" id="parentRow-1" data-row-num="parentRow-00">
                                  <td><input type="text" id="s1_quantity"  disabled="disabled" class="s1_quantity mrf-material frm-s1 not-full-width" name="s1_quantity"/></td>
                                  <td><select id="s1_brand" class="s1_brand frm-s1 chosen-select" data-s1-brand-row="1" name="s1_brand"></select></td>
                                  <td><select id="s1_id_model" class="mrf-material s1_id_model frm-s1 chosen-select s1_model_row_1" name="s1_id_model"></select></td>
                                  <td>
                                    <select id="s1_bn_rf" class="mrf-material s1_bn_rf frm-s1" name="s1_bn_rf">
                                      <option value="">---</option>
                                      <option value="1">Brand New (BN)</option>
                                      <option value="2">Refurbished (RF)</option>
                                    </select>
                                  </td>
                                  <td><input type="text" id="s1_accessories" class="s1_accessories mrf-material frm-s1" name="s1_accessories"/></td>
                                  <td>                                   
                                    <button type="button" onClick="dtCurrentMrf.getTrIndexSerial(this)" class="btn btn-flat btn-success btn-xs btn_s1_add_toner" title="Add Serial Number" data-toggle="modal" data-target="#modalS1Serial">+</button>
                                     <input type="hidden" id="s1_serialnum" class="s1_serialnum mrf-material frm-s1 validate-hidden-text" name="s1_serialnum" value=""/> 
                                  </td>                                 
                                  <td>
                                    <button type="button" onClick="dtCurrentMrf.getTrIndex(this)" class="btn btn-flat btn-success btn-xs btn_s1_add_toner" title="Add Toner" data-toggle="modal" data-target="#modalS1Toner">+</button>
                                    <input type="hidden" id="s1_toner" class="s1_toner validate-hidden-text" name="s1_toner" value="">
                                  </td>
                                  <td></td>
                                </tr>
                             <!--    <tr class="subRowSerial first-subRow"></tr>
                                <tr class="subRow first-subRow"></tr> -->
                              </tbody>
                             
                           </table>
                           <button type="button" class="btn btn-success btn-flat btn-xs pull-right" id="btn_add_row_s1">Add row</button>
                        </div>
                      </div>
                    </div>

        			<div class="col-md-12 form-section form-component-2">
        				<h4>Step 2</h4>
        				<div class="form-group section-one"> 
                        <p class="col-sm-12"><em>Place indicate the details below of machines for upgrade/replacement:</em></p>
                          <div class="col-sm-12">                    
                              <div class="col-md-2">  
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-1" value="1" name="radioBtn-group-c2" class="radioBtn-group-c2">Additional unit
                                  </label>   
                              </div> 

                              <div class="col-md-2" style="display: none">
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-2"  value="2" name="radioBtn-group-c2" class="radioBtn-group-c2">Upgrade/Replaced unit
                                  </label>      
                              </div> 

                              <div class="col-md-2">
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-upgrade"  value="5" name="radioBtn-group-c2" class="radioBtn-group-c2">Upgrade unit
                                  </label>      
                              </div> 

                              <div class="col-md-2">
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-replace"  value="6" name="radioBtn-group-c2" class="radioBtn-group-c2">Replace unit
                                  </label>      
                              </div> 


                               <div class="col-md-3">
                                <div class="col-sm-12">  
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-3" name="radioBtn-group-c2" class="radioBtn-group-c2" for="txtDemoRental" value="3">Demo / Rental: 
                                  </label>    
                                </div>

                                <div class="col-sm-12">
                                  <input type="text" id="txtDemoRental"  class="mrf-material" name="txtDemoRental" class="radioBtn-group-c2" disabled />
                                  <span># of days</span>
                                </div>
                              </div> 

                              <div class="col-md-3">
                                <div class="col-sm-12">  
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-4" name="radioBtn-group-c2"  class="radioBtn-group-c2" for="txtOthers" value="4">Others
                                  </label>    
                                </div>

                                <div class="col-sm-12">
                                  <input type="text" id="txtOthers"  class="mrf-material" name="txtOthers" disabled />
                                </div>
                              </div> 

                          </div>
                          <div class="col-sm-12">
                            <div class="mrf-table-responsive" style="overflow: unset;">  
        	                    <table id="tbl_frm_component_2" class="table"> 
        	                        <thead>  
        	                          <tr> 
        	                            <th> Brand</th>
                                      <th> Model</th>
        	                            <th> Serial Number </th>
        	                            <th> Contact Person </th>
        	                            <th> Department/Branch </th>
        	                            <th>  </th>
        	                          </tr>
        	                        </thead>
        	                        <tbody > 
        	                            <tr class="not-tr" data-row-num="parentRow-0">
                                        <td><select id="s2_id_brand" class="form-control s2_id_brand frm-s1 chosen-select" data-s2-brand-row="1" name="s2_id_brand"></select></td>
                                        <td><select id="s2_id_model" class="mrf-material s2_id_model frm-s1 chosen-select s2_model_row_1" name="s2_id_model"></select></td>
        	                              <td><input type="text" id="s2_serialnum"  class="mrf-material s2_serialnum" name="s2_serialnum"/> </td>
        	                              <td><input type="text" id="s2_contact_p"  class="mrf-material s2_contact_p" name="s2_contact_p"/> </td>
        	                              <td><input type="text" id="s2_dept_branch"  class="mrf-material s2_dept_branch" name="s2_dept_branch"/> </td>
        	                              <td><!-- <button type="button" title="Delete" class="btn btn-flat btn-danger btn-xs delete_row ">X</button> --> </td>
        	                            </tr>
                                      <tr class="subRow"></tr>
        	                        </tbody>
        	                    </table>
                             <button type="button" class="btn btn-success btn-flat btn-xs pull-right" id="btn_add_row_s2">Add row</button>
                            </div>
                       </div>
                      </div>

                      <div class="form-group section-two">
                         <div class="col-md-12">     
                            <p class="col-sm-12"><em>Place a tick on the appropriate button:</em></p>

                              <div class="col-md-4">   
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-5"  value="1" name="radioBtn-group-c3" class="radioBtn-group-c3">Technician will install
                                  </label>   
                              </div> 

                              <div class="col-md-4">    
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-6"  value="2" name="radioBtn-group-c3" class="radioBtn-group-c3">Client IT will install
                                  </label>   
                              </div> 

                              <div class="col-md-4">
                                  <label class="radio-inline">
                                    <input type="radio" id="radioBtn-7"  value="3" name="radioBtn-group-c3" class="radioBtn-group-c3">Technician with client IT
                                  </label>     
                              </div> 
                          </div> 
                      </div>

        			 </div>

<!--         				<div class="col-md-12 form-section form-component-3">
        					<h4>Step 3</h4>
        					     <div class="col-md-12">     
                          <p class="col-sm-12"><em>Place a tick on the appropriate button:</em></p>

                            <div class="col-md-4">   
                                <label class="radio-inline">
                                  <input type="radio" id="radioBtn-5"  value="1" name="radioBtn-group-c3" class="radioBtn-group-c3">Technician will install
                                </label>   
                            </div> 

                            <div class="col-md-4">    
                                <label class="radio-inline">
                                  <input type="radio" id="radioBtn-6"  value="2" name="radioBtn-group-c3" class="radioBtn-group-c3">Client IT will install
                                </label>   
                            </div> 

                            <div class="col-md-4">
                                <label class="radio-inline">
                                  <input type="radio" id="radioBtn-7"  value="3" name="radioBtn-group-c3" class="radioBtn-group-c3">Technician with client IT
                                </label>     
                            </div> 

                        </div> 

        				</div> -->

        				<div class="col-md-12 form-section component-4 form-component-3">
        					<h4>Step 3</h4>
        			           <div class="col-md-6">
                          <div class="form-group">     
                            <label class="col-sm-5" for="dateRequest" >Date Requested:</label>
                            <div class="col-sm-7">
                              <input type="text" id="dateRequest" class="mrf-material" name="dateRequest" disabled />
                            </div>
                          </div> 
                        </div>

                        <div class="col-md-12">
                          <div class="form-group">     
                            <label class="col-sm-3" for="txtCompany">Company Name:</label>
                            <div class="col-sm-9">
                              <input type="text" id="txtCompany"  class="mrf-material" name="txtCompany" data-value=""/>
                            </div>
                          </div> 
                        </div>

                        <div class="col-md-12">
                          <div class="form-group">     
                            <label class=" col-sm-3" for="txtShipTo">Ship to address:</label>
                             <div class="col-sm-9">
                                <input type="text" id="txtShipTo"  class="mrf-material" name="txtShipTo"/>
                             </div>
                          </div> 
                        </div>


                          <div class="col-md-12">
                              <div class="form-group">    
                                  <label class="col-sm-3" for="txtBillTo">Bill to address:</label>
                                  <div class="col-sm-9"> 
                                      <input type="text" id="txtBillTo"  class="mrf-material" name="txtBillTo"/>
                                  </div>
                              </div> 
                          </div>   

                        <div class="col-md-12">
                            <div class="form-group">
                              <div class="col-md-4">     
                                <label  for="txtContactPerson">Contact Person:</label>
                                <input type="text" id="txtContactPerson"  class="mrf-material" name="txtContactPerson"/>
                              </div> 

                              <div class="col-md-4">     
                                <label for="txtDepartment">Department:</label>
                                <input type="text" id="txtDepartment"  class="mrf-material" name="txtDepartment"/>
                              </div> 

                              <div class="col-md-4">     
                                <label for="txtTelNo">Tel No:</label>
                                <input type="text" id="txtTelNo"  class="mrf-material" name="txtTelNo"/>
                              </div> 
<!-- 
                              <div class="col-md-3">     
                                <label for="slctBranchRequest">Branch</label>
                                <select name="slctBranchRequest" id="slctBranchRequest" style="padding: 5px 50px;"></select>
                              </div>  -->
                           
                            </div>
                        </div>

<!--                         <div class="col-md-12">
                            <div class="form-group">
                                <fieldset>
                                   <legend style="font-size:14px; font-weight: 700">P.O Attachment:  <small>(Images / PDF only)</small></legend>
                                     <form id="frmAttachment" enctype="multipart/form-data" class="form-horizontal">

                                      <div class="col-sm-6">
                                         <input type="file" name="attachment[]" id="attachment" onChange="fileUpload.validateAttach(this)" multiple="multiple">
                                      </div>
                                      <div>
                                         <span class="label label-warning" id="download-message-error">No file uploaded.</span>
                                         <input type="button" name="download" id="download" value="Download Attachment"  onClick="fileUpload.downloadZip()" class="btn btn-xs btn-flat btn-success">
                                      </div>
                                     
                                    </form>
                                </fieldset>
                            </div>
                        </div>    -->
                        <div class="col-md-6 attachment-form" style="margin-top: 10px;">
                              <div class="box box-success box-solid">
                                  <div class="box-header">
                                      <p class="box-title" style="font-size: 13px; font-weight: 700">P.O Attachment:  <small>(Images / PDF only)</small></p>
                                      <div class="box-tools pull-right">
                                          <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                                          </button>
                                      </div>
                                  </div>
                                  <div class="box-body">
                                      <form id="frmAttachment" enctype="multipart/form-data" class="form-horizontal">
                                        <div class="col-sm-12 attachment-upload-container" style="padding: 5px;">
                                           <input type="file" name="attachment[]" id="attachment" onChange="fileUpload.validateAttach(this,true)" multiple="multiple">
                                           <label for="attachment" id="current-attachment-trigger">Choose Files</label>
                                        </div> 
                                         <div class="col-sm-12 pre-list-attachment"></div>
                                         <div class="col-sm-12 post-list-attachment"></div>
                                      </form>
                                  </div>
                              </div>

                          </div>   

        				</div>

                    <div class="col-md-10" style="margin-top: 15px;">
                       <input type="button" name="btn_cancel" value="Cancel Request" class="btn btn-warning btn-sm btn-flat btn_cancel" id="btn_cancel"/>
                   
            				    <span class="form-navigation" style="margin-top:20px; margin-left: 10px; clear:both">    
                					<input type="button" name="btn_prev" value="Previous" class="btn btn-primary btn-sm btn-flat btn_prev" id="btn_prev"/>
                					<input type="button" name="btn_next" value="Next" class="btn btn-primary btn-sm btn-flat btn_next"  id="btn_next"/>
                					<input type="submit" name="btn_submit" value="Save" class="btn btn-primary btn-sm btn-flat btn_submit"/>

            				    </span>
                    </div>

        			</form>

        </div><!--end of modal-body-->

        <div class="modal-footer">
          <button type="button" class="btn btn-md btn-flat btn-danger" data-dismiss="modal" style="margin-top: 15px;">Close</button>
        </div>

      </div>
    </div>
  </div>


  <!-- Modal Adding Toner -->
  <div id="modalS1Toner" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width:auto; max-width: 900px">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Toner</h4>
        </div>
      <form id="frmS1Toner">
        <div class="modal-body">
           <div class="mrf-table-responsive">
                <input type="hidden" name="hdnTrIndexToner" id="hdnTrIndexToner" value="">
                <!-- <input type="hidden" name="hdnIdMrfS1" id="hdnIdMrfS1" value=""> -->
                    <table id="tbl_frm_s1_toner" class="table"> 
                        <thead>  
                          <tr> 
                            <th> Quantity </th>
                            <th> Mono/Colored </th>
                            <th> Toner Model </th>
                            <th> Unit Price </th>
                            <th> Yield </th>
                            <th> Total </th>
                            <th> Type </th>
                            <th> Rate</th>
                            <th></th>
                          </tr>
                        </thead>
                        <tbody > 
                        </tbody>
                        <tfoot>
                          <tr> 
                          <td colspan="4"></td> 
                          <td class="text-right"><strong>Grand Total:</strong></td>
                          <td class="text-left"><strong id="grandTotal">----</strong></td>     
                        </tr>
                      </tfoot>
                      </table>
           </div>
           <button type="button" class="btn btn-success btn-flat btn-xs pull-right" id="btn_add_row_s1_toner">Add row</button>           
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger btn-flat" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary btn-flat" id="btn_s1_toner_save">Save</button>
        </div>
       </form>
      </div>

    </div>
  </div> <!-- end Modal Toner -->

  <!-- Modal Adding Serial Number -->
  <div id="modalS1Serial" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Serial Number</h4>
        </div>
      <form id="frmS1Serial">
          <div class="modal-body">
             <div class="mrf-table-responsive">
                  <input type="hidden" name="hdnTrIndexSN" id="hdnTrIndexSN" value="">
                    <label style="display: block; text-align: center; margin-bottom: 20px">Quantity: <input type="text" id="qty" name="qty" /><button type="button" id="add" title="Add/Remove">+/-</button></label>
                    <div id="newSerialFields" class="text-center"></div>
             </div>
            <!--<button type="button" class="btn btn-success btn-flat btn-xs pull-right" id="btn_add_row_s1_toner">Add row</button>         -->   
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger btn-flat" data-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary btn-flat" id="btn_s1_serial_save">Save</button>
          </div>
      </form>
      </div>
    </div>
  </div> <!-- end Modal Toner -->

<style type="text/css">
.form-section{
	display: none;
}
.current{
	display: block;
}
/*.done{
	background: #6fe471;
  transition: all .4s;
}*/
.help-block{
  font-style: italic;
  font-weight: 700;
  display:block;
  /*width: 100%;*/
  color:#da2020;
}
#newSerialFields div {
  display:inline-block;
  margin-left: 5px;
  margin-bottom: 5px;
}
.s1_quantity {
  cursor: not-allowed;
  text-align: center;
}
#tbl_frm_s1_toner .mrf-material{
  max-width: 90px;
}
input[name='s1_toner_qty'], input[name='s1_quantity'] {
  width: 50px;
}
select[name='s1_toner_monocolor']{
  width: 100%;
}
select[name='s1_toner_monocolor'], select[name='s1_toner_type']{
  padding: 1px 0;
}
#tbl_frm_component_1>tbody>tr[data-row-num^="parentRow"] > td{
  border-top: 1px solid #ddd;
  /*border-bottom: 1px solid #ddd;*/ 
}

#tbl_frm_s1_toner input.s1_toner_total{
  background: #04040414;
  cursor: not-allowed;
}

#tbl_frm_component_1 input.mrf-material{
  line-height: 2;
}
#tbl_frm_component_1 select.mrf-material{
  padding: 6px;
}
</style>

<script type="text/javascript">
$(document).ready(function(){

//Remove click event.
$(".cd-multi-steps li a").click(function(e){
  e.preventDefault();
})

//Generate fields of serialnumbers.
dtCurrentMrf.addFieldsSerial(); 

//Validation Toner Form.
$("#frmS1Toner").validate({
    submitHandler: function(){

        var id = $("#hdnTrIndexToner").val() || null;
        if(id != null){
           promptMSG('success-update','Toner',null,null,true,true);
            $('.mif-modalPromptMSG').on('click','button',function(){//Hide modal Remove Toner.
              $('#modalS1Toner').modal('hide');
            });
           dtCurrentMrf.attachTableTonerData(id);
           $(".pre-list-attachment").html('');
        }else{
          alert('ID is empty.');
        }
    },
    rules: {
      s1_toner_qty: { required: function(elem){
        var trIndex1 =  $(elem).closest("tr").index(); //Not required all fields if Type is OUTRIGHT.      
        var typeVal1 =  $("#tbl_frm_s1_toner tbody tr:eq("+trIndex1+") .s1_toner_type").val();
            return ( typeVal1 == 1 ? false : true);
      }, /*min: 1,*/ digits: true },
      s1_toner_model:{ required: function(elem){
        var trIndex2 =  $(elem).closest("tr").index();     
        var typeVal2 =  $("#tbl_frm_s1_toner tbody tr:eq("+trIndex2+") .s1_toner_type").val();
             return ( typeVal2 == 1 ? false : true);
      } },
      s1_toner_price:{ required: function(elem){
        var trIndex3 =  $(elem).closest("tr").index();     
        var typeVal3 =  $("#tbl_frm_s1_toner tbody tr:eq("+trIndex3+") .s1_toner_type").val();
             return ( typeVal3 == 1 ? false : true);
      }, number: true },
      s1_toner_yield:{ required: function(elem){
        var trIndex4 =  $(elem).closest("tr").index();      
        var typeVal4 =  $("#tbl_frm_s1_toner tbody tr:eq("+trIndex4+") .s1_toner_type").val();
             return ( typeVal4 == 1 ? false : true);
      }, number: true },
      s1_toner_monocolor:{ required: function(elem){
        var trIndex5 =  $(elem).closest("tr").index();     
        var typeVal5 =  $("#tbl_frm_s1_toner tbody tr:eq("+trIndex5+") .s1_toner_type").val();
             return ( typeVal5 == 1 ? false : true);
      } },
    },
    messages: {
        s1_toner_qty: { required: "Required"},
        s1_toner_monocolor: { required: "Required"},
        s1_toner_model: { required: "Required"},
        s1_toner_price: { required: "Required"},
        s1_toner_yield: { required: "Required"}
    },
    errorElement: "em",
    errorPlacement: function ( error, element ) {
        // Add the `help-block` class to the error element
        error.addClass( "help-block" ).css('margin-top','0px');
        error.insertAfter( element );
        
      }
});

//Hack the core of jQuery validator plugin in this page only. This will multi-validate the same input name.
$.extend( $.validator.prototype, { 
      checkForm: function () {
      this.prepareForm();
      for (var i = 0, elements = (this.currentElements = this.elements()); elements[i]; i++) {
        if (this.findByName(elements[i].name).length != undefined && this.findByName(elements[i].name).length > 1) {
            for (var cnt = 0; cnt < this.findByName(elements[i].name).length; cnt++) {
            this.check(this.findByName(elements[i].name)[cnt]);
          }
        } 
        else {
            this.check(elements[i]);
        }
      }
          return this.valid();
      }
  });

//Validation Serial Form.
$("#frmS1Serial").validate({
    submitHandler: function(){
        var trIndex = $("#hdnTrIndexSN").val() || null;
        if(trIndex != null){
           promptMSG('success-update','Serial Numbers',null,null,true,true);
            $('.mif-modalPromptMSG').on('click','button',function(){//Hide modal Remove Toner.
              $('#modalS1Serial').modal('hide');
            });
           dtCurrentMrf.saveSerialNumber(trIndex);
        }else{
          alert('ID is empty.');
        }
    },
    rules: {
      s1_serial:{ required: function(){  return ($("#qty").val() > 0 ? true : false)  } },
      qty:{ required: true },
    },
    messages: {
      s1_serial: { required: "Required"},
      qty: { required: "Required"},
    },
    errorElement: "em",
    errorPlacement: function ( error, element ) {
        // Add the `help-block` class to the error element
        error.addClass( "help-block" ).css('margin-top','0px');
        error.insertAfter( element );        
      }
});

//Validation Step 1 Form.
  var form_mrf = $( "#frmCurrentMrf" ); 
      form_mrf.validate({ 
        submitHandler: function(form){
           var id = $("#hdnIdCurrentMrf").val() || '';
           if(id == ''){
               dtCurrentMrf.add(function(){
                    $('#frmCurrentMrf :text:not("[readonly],[disabled]")').val(''); //Reset the validation form. //NOT WORKING
                    $("#frmCurrentMrf :checkbox, #frmCurrentMrf :radio").prop('checked',false);
                    $("#tbl_frm_component_1 tbody tr.first-subRow").empty();
                    $(".s1_brand, .s2_id_brand").val(0).trigger('chosen:updated');
                    $(".s1_id_model, .s2_id_model").val(0).trigger('chosen:updated');
                    $(".s1_quantity, select.s1_bn_rf, #frmCurrentMrf input[type='hidden']").val('');                   
                    $("#txtCompany").data('value',0);//Reset attribute value to zero.  
                    $('.delete_row').trigger('click');
                    $("#tbl_frm_component_1 tbody tr").eq(0).removeData();// Delete the arbitrary data of del-id and toner-values.
                    // form_mrf.find("#form-code").text(dtCurrentMrf.g_form_no()); //regenerate the form no.          
               });
          }else{
              dtCurrentMrf.update(id,function(){
                dtCurrentMrf.tableValuesDeleteS1.length = 0; //Clear the array values.
                dtCurrentMrf.tableValuesDeleteS2.length = 0;
                dtCurrentMrf.tableValuesDeleteToner.length = 0;
                dtCurrentMrf.getData(id,true); //Refresh the form.
              });

          }
        },
        onkeyup: false,
        errorElement: "em",
        errorPlacement: function ( error, element ) {
          // Add the `help-block` class to the error element
          error.addClass( "help-block" ).css('margin-top','0px');
          
              if ( element.prop("type") == "radio") {
                  error.insertAfter( element.parent( "label" ) );
              }
              else if( element.data('chosen') ){
                   error.insertAfter( element.next("div") );
              } 
              else {
                  error.insertAfter( element );
              }

        }
    });

	function stepFormValidation(form, curIndex, callbackFormNagivate){

		if(curIndex == 0){ //Step 1 
			$( ".s1_brand").rules("add", { required: true, messages: { required: "Required", } });
      $( ".s1_serialnum").rules("add", { required: true, messages: { required: "Required", } });
      $( ".s1_id_model").rules("add", { required: true, messages: { required: "Required", } });
      $( ".s1_toner").rules("add", { required: true, messages: { required: "Required", } });
			$( ".s1_bn_rf ").rules("add", { required: true, messages: { required: "Required", } });
		}
		else if(curIndex == 1){ //Step 2
      $( ".s2_id_brand" ).rules("add", { required: function(){ return ($("#radioBtn-2").is(':checked') ? true : false); }, messages: { required: "Required", } });
      $( ".s2_id_model" ).rules("add", { required: function(){ return ($("#radioBtn-2").is(':checked') ? true : false); }, messages: { required: "Required", } });    
      $( ".s2_serialnum" ).rules("add", { required: function(){ return ($("#radioBtn-2").is(':checked') ? true : false); }, messages: { required: "Required", } }); 
      $( ".s2_contact_p" ).rules("add", { required: function(){ return ($("#radioBtn-2").is(':checked') ? true : false); }, messages: { required: "Required", } }); 
			$( ".s2_dept_branch" ).rules("add", { required: function(){ return ($("#radioBtn-2").is(':checked') ? true : false); }, messages: { required: "Required", } }); 
    
      $( "#txtDemoRental" ).rules("add", { required: function(){ return ($("#radioBtn-3").is(':checked') ? true : false); }, messages: { required: "Required", } });   
      $( "#txtOthers" ).rules("add", { required: function(){ return ($("#radioBtn-4").is(':checked') ? true : false); }, messages: { required: "Required", } }); 

      $( "#radioBtn-5" ).rules("add", {require_from_group: [1,".radioBtn-group-c3"] });  
      $( "#radioBtn-6" ).rules("add", {require_from_group: [1,".radioBtn-group-c3"] });  
      $( "#radioBtn-7" ).rules("add", {require_from_group: [1,".radioBtn-group-c3"] });  
		}
    // else if(curIndex == 2){ //Step 3
    //   $( "#radioBtn-5" ).rules("add", {require_from_group: [1,".radioBtn-group-c3"] });  
    //   $( "#radioBtn-6" ).rules("add", {require_from_group: [1,".radioBtn-group-c3"] });  
    //   $( "#radioBtn-7" ).rules("add", {require_from_group: [1,".radioBtn-group-c3"] });  
    // }
    else if(curIndex == 2){ //Step 3
      $("#txtCompany" ).rules("add", {required: true, isAttrDataValueZero: true, messages: {required: "Required", isAttrDataValueZero: "Required",} }); 
    }
		else{ return false; }


		if(form.valid() === true){
    		callbackFormNagivate();
			// navigateForm(curIndex() + 1);
	        // $elem_li.eq(curIndex() - 1).addClass('done'); //Indicator the previous step form is done.
	    }
	}

	// $("ul.main-link-navigation li").on('click','a',function(e){
	// 	e.preventDefault();
	// 	stepFormValidation(curIndex(),function(){
	// 		$link.removeClass('current-link'); //Remove previous class.
	// 		$(this).closest('li').addClass('current-link'); //Add a class in selected li item.
	// 		navigateForm($(this).closest('li').index()); //Get the current selected index of li and use to navigate step form.
	// 	});
	// });

	var $elem_li = $('ul.main-link-navigation li');
	$(".btn_next").click(function(e){
		e.preventDefault();
		stepFormValidation(form_mrf,curIndex(),function(){
        navigateForm(curIndex() + 1);
			
		});
		 
	});

	$(".btn_prev").click(function(e){
		$(form_mrf[0]).each(function(){ //Remove all form rules validation.
			 if($(this).is('input[type="text"]'))
          $(this).rules('remove');
		}); 

		e.preventDefault();
		navigateForm(curIndex() - 1);
	});

    $(".btn_submit").click(function(e){
      e.preventDefault();
      stepFormValidation(form_mrf,curIndex(),function(){
        navigateForm(0,true); //Back to first step in Request Form.
        form_mrf.submit();    
      });
     
  });

 navigateForm(0)//Start at first step.
}); //end of document ready
</script>
