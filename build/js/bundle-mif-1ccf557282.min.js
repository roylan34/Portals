var infowindow,geocode,machineCharts={brandDataOpt:[],dtInstance:{},dtInstanceLoc:{},pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Home</small>"),this},brands:function(){var t=[],e=null;return $.getJSON(assets+"php/charts/machine-charts.php",{type_chart:"brands"},function(e){$.each(e.aaData,function(e,a){t.push({y:parseInt(a.total_brands),label:a.brand_name,indexLabel:formatNumber(a.total_brands),id_brand:a.id_brand})})}).complete(function(){var a={animationEnabled:!0,title:{text:"Summary MIF Brands",culture:"es"},axisY:{gridThickness:1,interval:2e3},axisX:{labelFormatter:function(t){return null==t.label?"empty brand name":t.label},labelFontColor:"#00a65a",interval:1,labelAngle:0},data:[{click:function(t){var e=t.dataPoint.id_brand||0;self.machineCharts.showModels(e,t.dataPoint.label)},type:"column",color:"#23BFAA",fillOpacity:.9,dataPoints:t,indexLabelFontColor:"#dd4b39"}]};$("#chartBrands").ready(function(){$("#chartBrands").CanvasJSChart(a),$("button[type='button']").click(function(){var t=$(this);"on"==t.data("toggle")?(e=setInterval(function(){self.machineCharts.brands()},5e3),t.addClass("active"),$(".real-off").removeClass("active")):(window.clearInterval(e),t.addClass("active"),$(".real-on").removeClass("active"))})})}),this},showModels:function(t,e){$("#displayModelChart").load(pages+"charts/model.html",function(){$("#modalChartModel").modal("show"),autoDrpDown.getBrandName("#slctChartBrand"),$("#modalChartModel").find(".modal-title").text(e),self.machineCharts.renderModels(t),$("#slctChartBrand").change(function(){id_brand=$(this).val()||0,brand_text=0!=id_brand?$(this).find("option:selected").text():"w/o brand name",$("#modalChartModel").find(".modal-title").text(brand_text),self.machineCharts.renderModels(id_brand)})})},renderModels:function(t){return this.dtInstance=$("#dtChartModel").DataTable({dom:"flrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,bStateSave:!0,ordering:!1,ajax:{url:assets+"php/charts/machine-charts.php",type:"GET",data:{type_chart:"models",idBrand:t}},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+t.model+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+(t.total_machine||0)+"</span>"}}],columnDefs:[{responsivePriority:1,target:0}],deferRender:!0,footerCallback:function(t,e,a,n,s){var l=this.api(),o=l.column(2).data(),r=0;$.each(o,function(t,e){null!=e.total_machine&&(r+=parseInt(e.total_machine))}),$(l.column(2).footer()).html("Overall Total: "+formatNumber(r))}}),this},location:function(){return this.dtInstanceLoc=$("#chartlocation").DataTable({dom:"flrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,bStateSave:!0,ordering:!1,ajax:{url:assets+"php/charts/machine-charts.php",type:"GET",data:{type_chart:"location"}},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+(null!=t.branch_name?t.branch_name:"empty location")+"</span>"}},{data:null,render:function(t,e,a,n){var s=t.total_machine_location||0;return"<span class='text-center badge'>"+formatNumber(s)+"</span>"}}],columnDefs:[{responsivePriority:1,target:0}],deferRender:!0,footerCallback:function(t,e,a,n,s){var l=this.api(),o=l.column(2).data(),r=0;$.each(o,function(t,e){null!=e.total_machine_location&&(r+=parseInt(e.total_machine_location))}),$(l.column(2).footer()).html("Overall Total: "+formatNumber(r))}}),this}},dtArchiveCompany={dtInstance:{},dtInstanceLogs:null,btn:$("button[type='submit']"),render:function(t){return this.dtInstance=$("#dtArchiveCompany").DataTable({dom:"Blrtip",autoWidth:!1,responsive:!0,pageLength:25,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{processing:'<i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',infoEmpty:"No entries to show"},processing:!0,serverSide:!0,bDestroy:!0,ordering:!1,ajax:{url:assets+"php/company/getCompanyList.php",type:"POST",dataSrc:"records",beforeSend:function(){$(".dt-buttons a").addClass("disabled")},data:function(e){var a=$("#search-archive-branch").chosen().val();e.company=$("#search-archive-companyname").val(),e.category=$("#search-archive-category").val(),e.address=$("#search-archive-address").val(),e.s_branch=1==t?a:a||t,e.contactno=$("#search-archive-contactno").val(),e.accmngr=$("#search-archive-accmngr").chosen().val(),e.s_location=$("#search-archive-location").chosen().val(),e.action_view="archive_company",e.branch="1"==t?null:t},complete:function(){$(".dt-buttons a").removeClass("disabled")}},buttons:[{extend:"excel",className:"dt-company-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9],stripNewlines:!1},filename:"Archive Company "+getTodayDate()},{extend:"print",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9],format:{body:function(t,e,a){return 5===e?t.replace(/<br\s*\/?>/gi,'"\r\n"'):t}}},className:"dt-company-print hidden-xs",customize:function(t){$(t.document.body).find(".dt-column-branches").css("max-height","0px !important")}},{text:"Open Search Filter",className:"dt-button-search",action:function(t,e,a,n){$("#dt-head-search").slideToggle("fast",function(){$(this).is(":visible")?a[0].innerText="Close Search Filter":(a[0].innerText="Open Search Filter",$("#dt-head-search input[type='text']").val(""),$("#search-company-branch, #search-company-accmngr, #search-company-location").val(0).trigger("chosen:updated"),self.dtArchiveCompany.dtInstance.ajax.reload(null,!0))})}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){var s=t.sap_code||null;return null!=s?"<span class='text-center'><a href='#' title='View SAP Details' id='modalSapDetails'>"+s+"</a></span>":"---"}},{data:null,render:function(t,e,a,n){var s="",l=t.delsan_company;return"dosc"==l?s="green":"dbic"==l&&(s="blue"),"<span class='badge badge-"+s+"'>"+l.toUpperCase()+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class=''>"+t.company_name+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+t.client_category+"</span>"}},{data:null,width:"20%",render:function(t,e,a,n){return"<span class='text-center'><a href='#' title='View Map' id='modalMap' data-toggle='modal' data-target='#modalMap'>"+t.address+"</a></span>"}},{data:null,render:function(t,e,a,n){return"<div class='text-left dt-column-branches'>"+isEmpty(t.main_location)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-left dt-column-branches'>"+isEmpty(t.branches)+"</div>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.contact_no)+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.account_mngr_name)+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-left' style='color:#dd4b39'> BLOCKED </span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.date_last_visit)+"</span>"}},{data:null,render:function(t,e,a,n){var s=JSON.parse(Cookies.get("app_module_action"));return s&&"wr"==s.action_mif?"<button class='btn btn-xs btn-success btn-flat btnEditComp' data-comp='"+t.id+"'>Retrieve</button>":""}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,target:1}],deferRender:!0,preDrawCallback:function(t){$(".dt-button-search, .dt-company-excel, .dt-company-print, .dt-button-add").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-company-print").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".dt-company-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")}}),this},modalShow:function(t){$("#displayFormCompany").load(pages+"archive/retrieve-company.html",function(e,a,n){$("#modalArchiveCompanyList").modal("show");var s=Cookies.get("location");if(autoDrpDown.getBranchNameMulti("#slctCompanyBranch","100%",s,!0),autoDrpDown.getBranchNameMulti("#slctCompanyLocation","100%",s,!0),autoDrpDown.getClientName("#slctClientMngr","100%"),autoDrpDown.getSapCompany("#txtSapCompany",!0),null!=t){var l=$("button[type='submit']");$.ajax({type:"GET",url:assets+"php/company/getCompanyById.php",data:{idcompany:t},dataType:"json",beforeSend:function(){l.button("loading")},success:function(t){var e=t.aaData[0];$("#hdnIdCompany").val(e.id),$("#txtEditCompany").val(e.company_name),$("#txtSapCode").val(e.sap_code),$("#txtSapCompany").val(e.sap_code).trigger("chosen:updated"),$("#OldhdnEditCompany").val(e.company_name),$("#txtEditCategory").val(e.client_category),$("#txtEditAddress").val(e.address),$("#txtContactNo").val(e.contact_no),$("input[name='delsanCompany'][value='"+e.delsan_company+"']").prop("checked",!0),$("#OldhdnClientMngr").val(e.id_client_mngr),$("#slctClientMngr").val(e.id_client_mngr).trigger("chosen:updated"),$("#slctCompanyBranch").val(null==e.id_branches?null:e.id_branches.split(",")).trigger("chosen:updated"),$("#slctCompanyLocation").val(null==e.main_location?null:e.main_location).trigger("chosen:updated"),$("#OldIdBranches").val(e.id_branches),$("#slctStatus").val(e.status),$("#txtLastVisit").val(e.date_last_visit)},error:function(t,e,a){promptMSG("warning","ID Machine not exist.")},complete:function(){l.button("reset")}})}})},retrieve:function(){var t=$("button[type='submit']"),e=$("#hdnIdCompany").val(),a=$("#txtEditCompany").val(),n=$("#txtEditCategory").val(),s=$("#txtEditAddress").val(),l=$("#slctCompanyBranch").chosen().val()?$("#slctCompanyBranch").chosen().val().toString():"",o=$("#slctCompanyLocation").chosen().val()?$("#slctCompanyLocation").chosen().val().toString():"",r=$("#txtContactNo").val(),c=$("#txtSapCode").val(),i=$("input[name='delsanCompany']:checked").val(),d={idcompany:e,company:a,category:n,address:s,location:o,branch:l,contactno:r,accmngr:$("#slctClientMngr").chosen().val(),oldaccmngr:$("#OldhdnClientMngr").val(),oldbranch:$("#OldIdBranches").val(),status:$("#slctStatus option:selected").val(),user_id:Cookies.get("user_id"),last_visit:$("#txtLastVisit").val(),sap_code:c,delsan_comp:i};$.ajax({type:"POST",url:assets+"php/company/updateCompany.php",data:d,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t){self.dtArchiveCompany.dtInstance.ajax.reload(null,!1),autoDrpDown.cacheOptComp.splice(0,1),promptMSG("success-update","Company",null,null,!0,!0)},error:function(t,e){alert(t+e)},complete:function(){t.button("reset")}})},actions:function(){return $("table#dtArchiveCompany").on("click","button, a",function(t){t.preventDefault();var e=$(this),a=e.text().toLowerCase();if(e.closest("tr").hasClass("selected")||(self.dtArchiveCompany.dtInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected")),"retrieve"==a){var n=$(this).data("comp");self.dtArchiveCompany.modalShow(n)}"search"==a&&self.dtArchiveCompany.dtInstance.ajax.reload(null,!0),"reset"==a&&($("#dt-head-search input[type='text']").val(""),$("#search-archive-branch, #search-archive-accmngr, #search-archive-location").val(0).trigger("chosen:updated"),self.dtArchiveCompany.dtInstance.ajax.reload(null,!0))}),this}},dtArchiveMachine={dtMArchiveInstance:null,dtRenderDom:null,pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Archive</small>"),this},render:function(){this.dtMArchiveInstance=$("#dtArchiveMachine").DataTable({dom:"Blrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,sPaginationType:"full_numbers",ordering:!1,ajax:{url:assets+"php/archive/machine.php",data:{action:"view-all"},type:"GET"},buttons:[{extend:"excel",className:"dt-archMachine-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},filename:"MIF Archive "+getTodayDate()},{extend:"print",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,11,12,13,14,15]},className:"dt-archMachine-print hidden-xs",customize:function(t){$(t.document.body).find("h1").remove()}},{text:"Open Search Filter",className:"dt-button-machinesearch",action:function(t,e,a,n){$(".dt-head-machinesearch").slideToggle("fast",function(){$(this).is(":visible")?a[0].innerText="Close Search Filter":(a[0].innerText="Open Search Filter",$(".dt-head-machinesearch input[type='text'], select").val(""),self.dtArchiveMachine.dtMArchiveInstance.ajax.reload(null,!0))})}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,title:"Company name",render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.company_name)+"</span>"}},{data:null,title:"S/N",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.serialnumber)+"</span>"}},{data:null,title:"Brand",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.brand_name)+"</span>"}},{data:null,title:"Model",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.model)+"</span>"}},{data:null,title:"Category",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.category)+"</span>"}},{data:null,title:"Type",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.type)+"</span>"}},{data:null,title:"Page Count",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.page_count)+"</span>"}},{data:null,title:"Location Area",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.location_area)+"</span>"}},{data:null,title:"Department",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.department)+"</span>"}},{data:null,title:"No. of User",render:function(t,e,a,n){return"<span class='text-left'>"+t.no_of_user+"</span>"}},{data:null,title:"Remarks",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.remarks)+"</span>"}},{data:null,title:"Date Installed",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.date_installed)+"</span>"}},{data:null,title:"Unit Owned",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.unit_owned_by)+"</span>"}},{data:null,title:"Billing Type",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.billing_type)+"</span>"}},{data:null,title:"Location",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.branch_name)+"</span>"}},{data:null,title:"",render:function(t,e,a,n){return 1==parseInt(t.is_hard_delete)?"<button class='btn btn-xs btn-success btn-flat btn-archive-marchine' data-target='#modalFormArchiveMachine' data-toggle='modal' data-idmachine='"+t.id+"'>Retrieve</button>":""}}],columnDefs:[{targets:10,className:"never"}],deferRender:!0,fnDrawCallback:function(t){var e=JSON.parse(Cookies.get("app_module_action")),a=Cookies.get("is_client_user");return null==e||1==a?$(".btn-archive-marchine").remove():"r"==e.action_mif&&$(".btn-archive-marchine").remove(),!1},preDrawCallback:function(t){$(".dt-archMachine-excel, .dt-button-machinesearch, .dt-archMachine-print").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-archMachine-print").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".dt-archMachine-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")}});var t=new $.fn.dataTable.ColumnFilter(this.dtMArchiveInstance,{1:{html:"input",type:"text",width:"70px"},2:{html:"input",type:"text",width:"70px"},3:{html:"select",type:"select",width:"80px",values:[{value:"HP",label:"HP"},{value:"OKI",label:"OKI"},{value:"CANON",label:"CANON"},{value:"EPSON",label:"EPSON"},{value:"RICOH",label:"RICOH"},{value:"KODAK",label:"KODAK"},{value:"FUJITSU",label:"FUJITSU"},{value:"SAMSUNG",label:"SAMSUNG"},{value:"BROTHER",label:"BROTHER"},{value:"FUJI_XEROX",label:"FUJI_XEROX"}]},4:{html:"input",type:"text",width:"60px"},5:{html:"select",type:"select",width:"50px",values:[{value:"MFP",label:"MFP"},{value:"SFP",label:"SFP"}]},6:{html:"select",type:"select",width:"90px",values:[{value:"MONOCHROME",label:"MONOCHROME"},{value:"COLOR",label:"COLOR"}]},7:{html:"input",type:"text",width:"50px"},8:{html:"input",type:"text",width:"100px"},9:{html:"input",type:"text",width:"100px"},10:{html:"input",type:"text",width:"50px"},11:{html:"input",type:"text",width:"50px"},12:{html:"input",type:"text",width:"70px"},13:{html:"input",type:"text",width:"70px"},14:{html:"select",type:"select",width:"90px",values:[{value:"METER READING",label:"METER READING"},{value:"PER CARTRIDGE",label:"PER CARTRIDGE"},{value:"FSMA",label:"FSMA"},{value:"FIXED MONTHLY",label:"FIXED MONTHLY"},{value:"OUTRIGHT",label:"OUTRIGHT"}]},15:{html:"input",type:"text",width:"70px"}}),e=t.dataTable.table().header();return $(e).find("tr").eq(1).addClass("dt-head-machinesearch").css("display","none"),$(t.dataTable.table().node()).off("column-visibility.dt"),this},getData:function(t){if(""!=t){var e=$("button[type='submit']");$.ajax({type:"GET",url:assets+"php/machine/machine.php",data:{action:"view_id",idmachine:t},dataType:"json",beforeSend:function(){e.button("loading")},success:function(t){$.each(t.aaData,function(t,e){$("#hdnId").val(e.id),$("#txtArchiveSerialNum").val(e.serialnumber),$("#slctArchiveBrand").val(e.brand),$("#txtArchiveModel").val(e.model),$("#slctArchiveCategory").val(isUpperCase(e.category)),$("#slctArchiveType").val(isUpperCase(e.type)),$("#txtArchivePageCount").val(e.page_count),$("#txArchiveLocation").val(e.location_area),$("#txtArchiveDepartment").val(e.department),$("#txtArchiveNoUser").val(e.no_of_user),$("#txtArchiveRemarks").val(e.remarks),$("#txtArchiveDateInstall").val(e.date_installed),$("#txtArchiveUnitOwn").val(e.unit_owned_by),$("#slctArchiveBilling").val(isUpperCase(e.billing_type)),$("#txtArchiveBranch").val(e.branches).trigger("chosen:updated"),$("#slctArchiveCompany").val(e.company_id).trigger("chosen:updated")})},error:function(t,e,a){promptMSG("warning","ID Machine not exist.")},complete:function(){e.button("reset")}})}},retrieve:function(){var t=$("button[type='submit']"),e=$("#hdnId").val(),a=$("#slctArchiveCompany").chosen().val(),n=$("#txtArchiveSerialNum").val(),s=$("#slctArchiveBrand option:selected").val(),l=$("#txtArchiveModel").val(),o=$("#slctArchiveCategory option:selected").val(),r=$("#slctArchiveType option:selected").val(),c=$("#txtArchivePageCount").val(),i=$("#txArchiveLocation").val(),d=$("#txtArchiveDepartment").val(),p=$("#txtArchiveNoUser").val(),u=$("#txtArchiveRemarks").val(),m=$("#txtArchiveDateInstall").val(),h=$("#slctArchiveBilling option:selected").val(),f=$("#txtArchiveBranch").chosen().val(),v=$("#txtArchiveUnitOwn").val(),g={action:"retrieve",user_id:Cookies.get("user_id"),id:e,company_id:a,serialnum:n,brand:s,model:l,category:o,type:r,pagecount:c,location:i,department:d,nouser:p,remarks:u,dateinstall:m,billing:h,branch:f,unit_own:v};$.ajax({type:"POST",url:assets+"php/archive/machine.php",data:g,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t){0==t.aaData[0].status?promptMSG("custom","Can't retrieve due to company selected is <strong>Blocked!</strong>","<i class='fa fa-warning'></i>",null,!1,!0):self.dtArchiveMachine.dtMArchiveInstance.ajax.reload(function(){promptMSG("success-retrieve","Machine",null,null,!1,!1),$("#modalFormArchiveMachine").modal("hide")},!1)},error:function(t,e){console.log(t+e)},complete:function(){t.button("reset")}})},modalShowArchiveMachine:function(){$("#displayFormArchiveMachine").load(pages+"archive/retrieve-form.html",function(){autoDrpDown.getAllCompany("#slctArchiveCompany","100%"),autoDrpDown.getBranchNameOne("#txtArchiveBranch","100%",[1],!1),autoDrpDown.getBrandName("#slctArchiveBrand"),$("#txtArchiveSerialNum, #slctArchiveBrand, #txtArchiveModel").prop("disabled",!0)})},actions:function(){return $("#dtArchiveMachine tbody").on("click","button",function(t){t.preventDefault();var e=$(this);e.closest("tr").hasClass("selected")||(self.dtArchiveMachine.dtMArchiveInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected"));var a=e.data("idmachine");self.dtArchiveMachine.getData(a)}),this}},dtCompany={dtInstance:{},dtInstanceLogs:null,dtInstanceInOut:null,btn:$("button[type='submit']"),pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Current</small>"),this},render:function(t){return 0==$("#displayMap").children().length&&$("#displayMap").load(pages+"company/map.html"),this.dtInstance=$("#dtCompany").DataTable({dom:'Bl<"FilterMachine col-md-2 col-xs-12"><"DisplayMap">rtip',autoWidth:!1,responsive:!0,pageLength:25,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{processing:'<i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',infoEmpty:"No entries to show"},processing:!0,serverSide:!0,bDestroy:!0,ordering:!1,ajax:{url:assets+"php/company/getCompanyList.php",type:"POST",dataSrc:"records",beforeSend:function(){$(".dt-buttons a").addClass("disabled")},data:function(e){var a=$("#search-company-branch").chosen().val();delete e.columns,e.company=$("#search-company-companyname").val(),e.category=$("#search-company-category").val(),e.address=$("#search-company-address").val(),e.s_branch=1==t?a:a||t,e.contactno=$("#search-company-contactno").val(),e.accmngr=$("#search-company-accmngr").chosen().val(),e.s_location=$("#search-company-location").chosen().val(),e.delsan_comp=$("#search-company-delsan option:checked").val(),e.toner_model=$("#search-company-toner").chosen().val(),e.action_view="company",e.branch="1"==t?null:t},complete:function(){$(".dt-buttons a").removeClass("disabled")}},buttons:[{extend:"excel",className:"dt-company-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12],stripNewlines:!1},filename:"MIF Customer "+getTodayDate()},{extend:"print",exportOptions:{columns:[0,1,2,3,4,5,6,7,8,9,10,11,12],format:{body:function(t,e,a){return 6===e?t.toString().replace(/<br\s*\/?>/gi,'"\r\n"'):t}}},className:"dt-company-print hidden-xs",customize:function(t){$(t.document.body).find(".dt-column-branches").css("max-height","0px !important")}},{text:"Add New Company",className:"dt-button-add",action:function(t,e,a,n){self.dtCompany.modalShow()}},{text:"Open Search Filter",className:"dt-button-search",action:function(t,e,a,n){$("#dt-head-search").slideToggle("fast",function(){$(this).is(":visible")?a[0].innerText="Close Search Filter":(a[0].innerText="Open Search Filter",$("#dt-head-search input[type='text']").val(""),$("#search-company-branch, #search-company-accmngr, #search-company-location").val(0).trigger("chosen:updated"),self.dtCompany.dtInstance.ajax.reload(null,!0))})}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){var s=t.sap_code||null;return null!=s?"<span class='text-center'><a href='#' title='View SAP Details' id='modalSapDetails' data-toggle='modal' data-target='#modalSapDetails'>"+s+"</a></span>":"---"}},{data:null,render:function(t,e,a,n){var s="",l=t.delsan_company;return"dosc"==l?s="green":"dbic"==l&&(s="blue"),"<span class='badge badge-"+s+"'>"+l.toUpperCase()+"</span>"}},{data:"company_name"},{data:"client_category"},{data:"number_of_machines"},{data:null,width:"20%",render:function(t,e,a,n){return"<span class='text-center'><a href='#' title='View Map' id='showDtMap' data-idcomp='"+t.id+"' data-lat='"+t.latitude+"' data-lng='"+t.longitude+"'>"+t.address+"</a></span>"}},{data:null,render:function(t,e,a,n){return"<div class='text-left dt-column-branches'>"+isEmpty(t.main_location)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-left dt-column-branches'>"+isEmpty(t.branches)+"</div>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.contact_no)+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.account_mngr_name)+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.date_last_visit)+"</span>"}},{data:null,width:"10%",render:function(t,e,a,n){var s="";return s+='<div class="dropdown text-center">',s+='<button class="btn btn-success dropdown-toggle btn-sm" type="button" data-toggle="dropdown">Actions <span class="caret"></span></button><ul class="dropdown-menu"><li><a href="#" class="btnEditComp" data-comp="'+t.id+'"><i class="fa fa-pencil-square" aria-hidden="true"></i>EDIT</a></li><li>'+(1==t.status?'<a href="#" title="View MIF" class=" btnViewPrinter" data-comp="'+t.id+'" data-branch="'+t.id_branch+'" data-status="'+t.status+'" data-compname="'+encodeURIComponent(t.company_name)+'"><i class="fa fa-list"></i>VIEW MIF</a>':"")+'</li><li><a href="#" class="btnSalesHist" data-sapcode="'+t.sap_code+'"><i class="fa fa-bar-chart" ></i>SALES</a></li><li><a href="#" title="Activity Logs" class="viewMifLogs" data-comp="'+t.id+'" data-branch="'+t.id_branch+'">ACTIVITY LOGS</a></li></ul></div>'}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,target:1}],deferRender:!0,fnDrawCallback:function(t){var e=JSON.parse(Cookies.get("app_module_action"));return null==e?$(".btnEditComp, .dt-button-add, .viewMifLogs").remove():"r"==e.action_mif&&$(".btnEditComp, .dt-button-add, .viewMifLogs").remove(),!1},preDrawCallback:function(t){$(".dt-button-search, .dt-company-excel, .dt-company-print, .dt-button-add").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-company-print").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".dt-company-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")},footerCallback:function(e,a,n,s,l){var o=this.api(),r=function(t){return"string"==typeof t?1*t.replace(/[\$,]/g,""):"number"==typeof t?t:0},c=0;c=o.column(5,{page:"current"}).data().reduce(function(t,e){return r(t)+r(e)},0);var i=0,d=$("#search-company-branch").chosen().val()?$("#search-company-branch").chosen().val():t;$.ajax({type:"GET",url:assets+"php/misc/countmachines.php",data:{branch:d},dataType:"json",async:!1,success:function(t){i=t[0]},error:function(t,e,a){}}),$(o.column(4).footer()).html("Page Total:"+formatNumber(c)+" (Overall Total: "+formatNumber(i)+")").css("font-size","12px")}}),$("div.FilterMachine").html('<a href="#" class="filter-machine"><i class="fa fa-filter"></i>Filter Machine</a>'),this},modalShow:function(t){$("#displayFormCompany").load(pages+"company/form.html",function(e,a,n){$("#modalEditCompanyList").modal("show"),$("#showfrmMap").on("click",function(t){t.preventDefault(),$("#modalMap").modal("show");var e=$("#txtEditAddress").val(),a=$("#hdnIdCompany").val(),n=intVal($("#hdnLat").val()),s=intVal($("#hdnLng").val());self.dtCompany.view_map_by_address(e,a,{lat:n,lng:s})});var s=Cookies.get("location");if(autoDrpDown.getBranchNameMulti("#slctCompanyBranch","100%",s,!0),autoDrpDown.getBranchNameMulti("#slctCompanyLocation","100%",s,!0),autoDrpDown.getClientName("#slctClientMngr","100%"),autoDrpDown.getSapCompany("#txtSapCompany",!0),null!=t){$(this).find(".modal-title").text("Edit");var l=$("button[type='submit']");$.ajax({type:"GET",url:assets+"php/company/getCompanyById.php",data:{idcompany:t},dataType:"json",beforeSend:function(){l.button("loading")},success:function(t){var e=t.aaData[0];$("#hdnIdCompany").val(e.id),$("#txtEditCompany").val(e.company_name),$("#txtSapCode").val(e.sap_code),$("#txtSapCompany").val(e.sap_code).trigger("chosen:updated"),$("#OldhdnEditCompany").val(e.company_name),$("#txtEditCategory").val(e.client_category),$("#txtEditAddress").val(e.address),$("#txtContactNo").val(e.contact_no),$("input[name='delsanCompany'][value='"+e.delsan_company+"']").prop("checked",!0),$("#OldhdnClientMngr").val(e.id_client_mngr),$("#slctClientMngr").val(e.id_client_mngr).trigger("chosen:updated"),$("#slctCompanyBranch").val(null==e.id_branches?null:e.id_branches.split(",")).trigger("chosen:updated"),$("#slctCompanyLocation").val(null==e.main_location?null:e.main_location).trigger("chosen:updated"),$("#OldIdBranches").val(e.id_branches),$("#slctStatus").val(e.status),$("#txtLastVisit").val(e.date_last_visit),$("#hdnLat").val(e.latitude),$("#hdnLng").val(e.longitude)},error:function(t,e,a){promptMSG("warning","ID Machine not exist.")},complete:function(){l.button("reset")}})}else $(this).find(".modal-title").text("Add"),$("#slctCompanyBranch, #slctClientMngr, #slctCompanyLocation").val(0).trigger("chosen:updated")})},edit:function(){var t=$("button[type='submit']"),e=$("#hdnIdCompany").val(),a=$("#txtEditCompany").val(),n=$("#txtEditCategory").val(),s=$("#txtEditAddress").val(),l=$("#slctCompanyBranch").chosen().val()?$("#slctCompanyBranch").chosen().val().toString():"",o=$("#slctCompanyLocation").chosen().val()?$("#slctCompanyLocation").chosen().val().toString():"",r=$("#txtContactNo").val(),c=$("#txtSapCode").val(),i=$("input[name='delsanCompany']:checked").val(),d={idcompany:e,company:a,category:n,address:s,location:o,branch:l,contactno:r,accmngr:$("#slctClientMngr").chosen().val(),oldaccmngr:$("#OldhdnClientMngr").val(),oldbranch:$("#OldIdBranches").val(),status:$("#slctStatus option:selected").val(),user_id:Cookies.get("user_id"),last_visit:$("#txtLastVisit").val(),sap_code:c,delsan_comp:i,lat:$("#hdnLat").val(),lng:$("#hdnLng").val()};$.ajax({type:"POST",url:assets+"php/company/updateCompany.php",data:d,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t){self.dtCompany.dtInstance.ajax.reload(null,!1),autoDrpDown.cacheOptComp.splice(0,1),promptMSG("success-update","Company",null,null,!0,!0)},error:function(t,e){alert(t+e)},complete:function(){t.button("reset")}})},add:function(){var t=$("button[type='submit']"),e=$("#txtEditCompany").val(),a=$("#txtEditCategory").val(),n=$("#txtEditAddress").val(),s=$("#slctCompanyBranch").chosen().val()?$("#slctCompanyBranch").chosen().val().toString():"",l=$("#slctCompanyLocation").chosen().val()?$("#slctCompanyLocation").chosen().val().toString():"",o=$("#txtContactNo").val(),r=$("#txtSapCode").val(),c=$("input[name='delsanCompany']:checked").val(),i=$("#slctClientMngr").chosen().val(),d=$("#slctStatus option:selected").val(),p=Cookies.get("user_id"),u=$("#txtLastVisit").val(),m=$("#hdnLat").val(),h=$("#hdnLng").val(),f={company:e,category:a,address:n,location:l,branch:removeDblQuote(s),contactno:o,accmngr:i,status:d,user_id:p,last_visit:u,sap_code:r,delsan_comp:c,lat:m,lng:h};$.ajax({type:"POST",url:assets+"php/company/addCompany.php",data:f,dataType:"json",beforeSend:function(){$("#dt-head-search input[type='text']").val(""),t.button("loading")},success:function(t,e,a){self.dtCompany.dtInstance.ajax.reload(null,!1),promptMSG("success-add","Company",null,null,!0,!0)},error:function(t,e){alert(t+e)},complete:function(){resetForm("#frmCompany"),$("#slctCompanyBranch, #slctClientMngr").val(0).trigger("chosen:updated"),t.button("reset")}})},actions:function(){return $("table#dtCompany").on("click","button, a",function(t){t.preventDefault();var e=$(this),a=e.text().toLowerCase();if(e.closest("tr").hasClass("selected")||(self.dtCompany.dtInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected")),"edit"==a){var n=$(this).data("comp");self.dtCompany.modalShow(n)}else if($(e[0]).hasClass("btnViewPrinter")){n=e.data("comp");var s=decodeURIComponent(e.data("compname")),l=e.data("branch");dtMachine.render(n,s,l,"admin")}else if($(e[0]).hasClass("viewMifLogs")){n=e.data("comp");self.dtCompany.modal_mif_logs(n)}else if("sales"==a){var o=e.data("sapcode");dtSalesHistory.render(o)}else if("search"==a)self.dtCompany.dtInstance.ajax.reload(null,!0);else if("reset"==a)$("#dt-head-search input[type='text'], #search-company-delsan").val(""),$("#search-company-branch, #search-company-accmngr, #search-company-location, #search-company-toner").val(0).trigger("chosen:updated"),self.dtCompany.dtInstance.ajax.reload(null,!0);else if($(e[0]).is("#showDtMap")){$("#modalMap").modal("show");var r=e.text(),c=e.data("idcomp"),i=intVal(e.data("lat")),d=intVal(e.data("lng"));self.dtCompany.view_map_by_address(r,c,{lat:i,lng:d})}else if($(e[0]).is("#modalSapDetails")){var p=e.text();self.dtCompany.view_sap_details(p)}}),this},modal_mif_logs:function(t){return $("#displayViewMifLogs").load(pages+"company/logs.html",function(){$("#modalMifLogs").modal("show"),self.dtCompany.dataTable_mif_logs(t)}),this},dataTable_mif_logs:function(t){var e=$("#btnSearchMifLogs");return this.dtInstanceLogs=$("#dtMifLogs").DataTable({dom:"<'search-toolbar'>lrtip",autoWidth:!1,processing:!0,serverSide:!0,ordering:!1,destroy:!0,responsive:!0,ajax:{url:assets+"php/company/mifLogs.php",type:"POST",dataSrc:"records",beforeSend:function(){e.button("loading")},data:function(e){e.company_id=t||0,e.search={value:$("#txtSearchLogs").val()||null}}},columns:[{data:null},{data:"serialnumber"},{data:"fullname"},{data:"updated_at"},{data:null},{data:null}],columnDefs:[{targets:0,render:function(t,e,a,n){return n.row+1}},{targets:4,render:function(t,e,a,n){var s="",l=t.action;return"CREATE"==l?s="badge-blue":"UPDATE"==l?s="badge-green":"REMOVE"==l&&(s="badge-red"),"<span class='badge "+s+"'>"+l+"</span>"}},{targets:5,render:function(t,e,a,n){var s=t.reason;return""!=s?'<a href="#" style="color: #c34838" data-toggle="popover" title="Reason" data-placement="right" data-content="'+s+'" data-trigger="focus"><i class="fa fa-comment"></i></a>':""}}],drawCallback:function(){$('[data-toggle="popover"]').popover().on("click",function(t){t.preventDefault()})}}),$("div.search-toolbar").html("<div class='pull-right'><input type='search' id='txtSearchLogs' placeholder='Search' style='margin-right:10px'/><a href='#' class='btn btn-flat btn-xs btn-primary' id='btnSearchMifLogs'><i class='fa fa-search' title='Search'></i></a></div>"),$("#btnSearchMifLogs").click(function(t){t.preventDefault(),self.dtCompany.dtInstanceLogs.ajax.reload()}),this},view_map_by_address:function(t,e,a){var n=[];return function(t){var e,a;t.lat>0&&t.lng>0?(e=t,a=13):(e={lat:11.326683,lng:122.957248},a=6);var s=new google.maps.Map(document.getElementById("map-container"),{zoom:a,center:e,gestureHandling:"greedy"}),l=new google.maps.Geocoder;document.getElementById("btnGeoCode").addEventListener("click",function(){!function(t,e){var a=document.getElementById("mapAddress").value,s=new google.maps.Marker({map:e});t.geocode({address:a},function(t,l){"OK"===l?(function(){for(var t=0;t<n.length;t++)n[t].setMap(null)}(),s.setPosition(t[0].geometry.location),n.push(s),e.setCenter(t[0].geometry.location),e.setZoom(13),$("#showLat").text(" "+t[0].geometry.location.lat()),$("#showLng").text(" "+t[0].geometry.location.lng()),$("#hdnLat").val(t[0].geometry.location.lat()),$("#hdnLng").val(t[0].geometry.location.lng()),$("#txtEditAddress").val(a)):alert("Geocode was not successful for the following reason: "+l)})}(l,s)})}(a),$("#modalMap").on("shown.bs.modal",function(){$("#mapAddress").val(t),$("#hdnLat").val(a.lat),$("#hdnLng").val(a.lng),$(this).find("#showLat").text(a.lat),$(this).find("#showLng").text(a.lng)}),$("#modalMap").on("hidden.bs.modal",function(){$("#showLat, #showLng").text(""),$("#mapAddress, #idComp").val(""),($("#modalEditCompanyList").data("bs.modal")||{}).isShown&&$("body").addClass("modal-open")}),this},view_sap_details:function(t){"---"!=t?$.ajax({type:"GET",url:assets+"php/misc/sap_details.php",data:{action:"all",sap_code:t},dataType:"json",success:function(t){var e=t.aaData;e.length>0?($("#sap_code").text(e[0].sap_code),$("#sap_company").text(e[0].company_name),$("#sap_category").text(e[0].client_category),$("#sap_address").text(e[0].address),$("#sap_location").text(e[0].location),$("#sap_contact").text(e[0].contact_no),$("#sap_acct_mngr").text(e[0].account_mngr),$(".sap-message").hide()):($(".sap-val").text("---"),$(".sap-message").show())},error:function(t,e,a){alert("Something went wrong!")}}):alert("Empty SAP Code.")},countMachines:function(t){var e=$("#date-from").val(),a=$("#date-to").val(),n=setInterval(function(){$.ajax({type:"GET",url:assets+"php/misc/countmachines.php",data:{branch:t,dateFrom:e,dateTo:a},dataType:"json",beforeSend:function(){$(".mif-info-box h3.total-mif").fadeTo("fast",.33)},success:function(t){$(".mif-info-box .inner h3.total-mif").text(t[0]),$(".mif-info-box .inner ul li h4.total-client-active").text("ACTIVE: "+t[1]),$(".mif-info-box .inner ul li h4.total-client-blocked").text("BLOCKED: "+t[2]),$(".mif-info-box .inner #total-in a").text(t[3]),$(".mif-info-box .inner #total-out a").text(t[4])},error:function(t,e,a){},complete:function(){$(".mif-info-box, .mif-info-box h3.total-mif").fadeTo("slow",1)}}),"current"!=window.location.hash.slice(2)&&window.clearInterval(n)},2e4);return this},countInOutMachine:function(){var t=$("#date-from").val(),e=$("#date-to").val();$.ajax({type:"GET",url:assets+"php/misc/count_in_out_machines.php",data:{dateFrom:t,dateTo:e},dataType:"json",success:function(t){$("#total-in a").text(t[0]),$("#total-out a").text(t[1])},error:function(t,e,a){alert("Something went wrong!")}})},viewInOutMachine:function(t){var e=t;if(e){var a=e.getAttribute("data-type").toUpperCase()+" Machines ";$("#modalInOut .modal-title").text(a),this.dtInstanceInOut=$("#dtInOut").DataTable({dom:"Blrtip",ordering:!1,autoWidth:!1,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],pageLength:15,serverSide:!0,processing:!0,language:{processing:'<i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',infoEmpty:"No entries to show"},destroy:!0,responsive:!0,buttons:[{extend:"excel",className:"btn-excel-inout hidden-xs",exportOptions:{columns:[1,2,3,4,5]},filename:a+getTodayDate()},{extend:"print",exportOptions:{columns:[0,1,2,3,4,5]},className:"btn-print-inout hidden-xs",customize:function(t){var e=$(t.document.body);e.find("h1").remove(),e.prepend("<h4>"+a+"</h4>")}}],ajax:{url:assets+"php/misc/listInOutMachines.php",type:"POST",dataSrc:"records",data:function(t){t.serialnumber=$("#search-inout-serial").val()||"",t.brand=$("#search-inout-brand option:selected").val()||"",t.model=$("#search-inout-model").val()||"",t.company=$("#search-inout-company").val()||"",t.type=e.getAttribute("data-type"),t.dateFrom=$("#date-from").val()||"",t.dateTo=$("#date-to").val()||""}},columns:[{data:null},{data:"serialnumber"},{data:"brand_name"},{data:"model"},{data:"company_name"},{data:"date"}],columnDefs:[{targets:0,render:function(t,e,a,n){return n.row+1}}],preDrawCallback:function(t){$(".btn-excel-inout, .btn-print-inout").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".btn-print-inout").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".btn-excel-inout").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")}})}return this}},dtMachine={dtMInstance:null,dtRenderDom:null,render:function(t,e,a,n){return this.dtRenderDom=$("#displayViewMachine").load(pages+"machine/modal/index.html",function(s,l,o){if("success"==l){$("#modalMachineList").modal("show");var r=null==a||""==a?null:convertArrStrToInt(a);$(this).find("#machine-company").text("Machine list in "+e),self.dtMachine.dataTable(t,r,n).addButton(t).actions(),self.dtMachine.modalShowMachine(r)}else alert(o.status+"File not found.")}),this},dataTable:function(t,e,a){var n="1"==Cookies.get("location")?null:Cookies.get("location");this.dtMInstance=$("#dtMachine").DataTable({dom:"Blrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,sPaginationType:"full_numbers",ordering:!1,ajax:{url:assets+"php/machine/getMachineListByCompany.php",data:{company_id:t,branch:n,department:a,user_id:Cookies.get("user_id")},type:"GET",beforeSend:function(){$(".btnViewPrinter").prop("disabled",!0)},complete:function(t){$.each($(".btnViewPrinter"),function(t,e){1==$(this).data("status")?$(this).prop("disabled",!1):$(this).prop("disabled",!0)})}},buttons:[{extend:"excel",className:"dt-company-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]},filename:"MIF "+getTodayDate()},{extend:"print",exportOptions:{columns:[0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]},className:"dt-machine-print hidden-xs",customize:function(t){var e=$(t.document.body);e.find("h1").remove();var a=$("#modalMachineList").find(".modal-title").text();e.prepend("<h4>"+a+"</h4>")}},{text:"Open Search Filter",className:"dt-button-machinesearch",action:function(t,e,a,n){$(".dt-head-machinesearch").slideToggle("fast",function(){$(this).is(":visible")?a[0].innerText="Close Search Filter":(a[0].innerText="Open Search Filter",$(".dt-head-machinesearch input[type='text'], select").val(""),self.dtMachine.dtMInstance.ajax.reload(null,!0))})}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,title:"Company name",render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.company_name)+"</span>"}},{data:null,title:"S/N",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.serialnumber)+"</span>"}},{data:null,title:"Brand",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.brand_name)+"</span>"}},{data:null,title:"Model",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.model)+"</span>"}},{data:null,title:"Toner",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.toner)+"</span>"}},{data:null,title:"Category",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.category)+"</span>"}},{data:null,title:"Type",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.type)+"</span>"}},{data:null,title:"Page Count",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.page_count)+"</span>"}},{data:null,title:"Location Area",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.location_area)+"</span>"}},{data:null,title:"Department",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.department)+"</span>"}},{data:null,title:"No. of User",render:function(t,e,a,n){return"<span class='text-left'>"+t.no_of_user+"</span>"}},{data:null,title:"Remarks",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.remarks)+"</span>"}},{data:null,title:"Date Installed",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.date_installed)+"</span>"}},{data:null,title:"Unit Owned",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.unit_owned_by)+"</span>"}},{data:null,title:"Account Manager",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.account_manager)+"</span>"}},{data:null,title:"Date last visit",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.date_last_visit)+"</span>"}},{data:null,title:"Billing Type",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.billing_type)+"</span>"}},{data:null,title:"Location",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.branches)+"</span>"}},{data:null,render:function(t,e,a,n){return"<button class='btn btn-xs btn-success btn-flat btnViewUpdateMachine' data-target='#modalFormMachine' data-toggle='modal' data-machine='"+t.id+"'>Update</button>"}},{data:null,render:function(t,e,a,n){return"<a href='#' class='btn btn-xs btn-warning btn-flat btnRemoveMachine' data-machine='"+t.id+"' title='Remove'><i class='fa fa-trash'></i></a>"}}],columnDefs:[{targets:1,className:"never"},{targets:15,className:"none"},{targets:16,className:"none"}],deferRender:!0,fnDrawCallback:function(t){var e=JSON.parse(Cookies.get("app_module_action")),a=Cookies.get("is_client_user");return null==e||1==a?$(".btnViewUpdateMachine, .dt-button-machineadd, .btnRemoveMachine").remove():"r"==e.action_mif&&$(".btnViewUpdateMachine, .dt-button-machineadd, .btnRemoveMachine").remove(),!1},preDrawCallback:function(t){$(".dt-company-excel, .dt-button-machinesearch, .dt-machine-print").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-machine-print").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".dt-company-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")}});var s=new $.fn.dataTable.ColumnFilter(this.dtMInstance,{1:{html:"input",type:"text",width:"70px"},2:{html:"input",type:"text",width:"70px"},3:{html:"select",type:"select",width:"80px",values:[{value:"HP",label:"HP"},{value:"OKI",label:"OKI"},{value:"CANON",label:"CANON"},{value:"EPSON",label:"EPSON"},{value:"RICOH",label:"RICOH"},{value:"KODAK",label:"KODAK"},{value:"FUJITSU",label:"FUJITSU"},{value:"SAMSUNG",label:"SAMSUNG"},{value:"BROTHER",label:"BROTHER"},{value:"FUJI_XEROX",label:"FUJI_XEROX"}]},4:{html:"input",type:"text",width:"60px"},5:{html:"input",type:"text",width:"60px"},6:{html:"select",type:"select",width:"50px",values:[{value:"MFP",label:"MFP"},{value:"SFP",label:"SFP"}]},7:{html:"select",type:"select",width:"90px",values:[{value:"MONOCHROME",label:"MONOCHROME"},{value:"COLOR",label:"COLOR"}]},8:{html:"input",type:"text",width:"50px"},9:{html:"input",type:"text",width:"100px"},10:{html:"input",type:"text",width:"100px"},11:{html:"input",type:"text",width:"50px"},12:{html:"input",type:"text",width:"50px"},13:{html:"input",type:"text",width:"70px"},14:{html:"input",type:"text",width:"70px"},15:{html:"select",type:"select",width:"90px",values:[{value:"METER READING",label:"METER READING"},{value:"PER CARTRIDGE",label:"PER CARTRIDGE"},{value:"FSMA",label:"FSMA"},{value:"FIXED MONTHLY",label:"FIXED MONTHLY"},{value:"OUTRIGHT",label:"OUTRIGHT"}]},16:{html:"input",type:"text",width:"70px"}}),l=s.dataTable.table().header();return $(l).find("tr").eq(1).addClass("dt-head-machinesearch").css("display","none"),$(s.dataTable.table().node()).off("column-visibility.dt"),this},modalShowMachine:function(t){$("#displayFormMachine").load(pages+"machine/modal/form.html",function(){$("#modalFormMachine .modal-title").attr("data-update-opt","1"),autoDrpDown.getAllCompany("#slctCompany","60%"),autoDrpDown.getBranchNameOne("#txtBranch","100%",t,!0),autoDrpDown.getBrandName("#slctBrands")})},getData:function(t){if(null!=t){$("#displayFormMachine").find(".modal-title").text("Update Machine");var e=$("button[type='submit']");$.ajax({type:"GET",url:assets+"php/machine/machine.php",data:{action:"view_id",idmachine:t},dataType:"json",beforeSend:function(){e.button("loading")},success:function(t){$.each(t.aaData,function(t,e){$("#hdnId").val(e.id),$("#hdnOldSerial, #txtSerialNum").val(e.serialnumber),$("#slctBrands").val(e.brand),$("#txtModel").val(e.model),$("#slctCategory").val(isUpperCase(e.category)),$("#slctType").val(isUpperCase(e.type)),$("#txtPageCount").val(e.page_count),$("#txtLocation").val(e.location_area),$("#txtDepartment").val(e.department),$("#txtNoUser").val(e.no_of_user),$("#txtRemarks").val(e.remarks),$("#txtDateInstall").val(e.date_installed),$("#txtUnitOwn").val(e.unit_owned_by),$("#slctBilling").val(isUpperCase(e.billing_type)),$("#txtBranch").val(e.branches).trigger("chosen:updated"),$(autoDrpDown.cacheOptCompInst).val(e.company_id).trigger("chosen:updated"),$(autoDrpDown.cacheOptCompInst).prop("disabled",!1).trigger("chosen:updated")})},error:function(t,e,a){promptMSG("warning","ID Machine not exist.")},complete:function(){e.button("reset")}})}else $("#displayFormMachine").find(".modal-title").text("Add New Machine")},update:function(){var t=$("button[type='submit']"),e={action:"update",idmachine:$("#hdnId").val(),company_id:$("#slctCompany").chosen().val(),serialnum:$("#txtSerialNum").val(),brand:$("#slctBrands option:selected").val(),model:$("#txtModel").val(),category:$("#slctCategory option:selected").val(),type:$("#slctType option:selected").val(),pagecount:$("#txtPageCount").val(),location:$("#txtLocation").val(),department:$("#txtDepartment").val(),nouser:$("#txtNoUser").val(),remarks:$("#txtRemarks").val(),dateinstall:$("#txtDateInstall").val(),billing:$("#slctBilling option:selected").val(),branch:$("#txtBranch").chosen().val(),unit_own:$("#txtUnitOwn").val(),user_id:Cookies.get("user_id")};$.ajax({type:"POST",url:assets+"php/machine/machine.php",data:e,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t){0==t.aaData[0].status?promptMSG("custom","Can't update due to company selected is <strong>Blocked!</strong>","<i class='fa fa-warning'></i>",null,!1,!0):self.dtMachine.dtMInstance.ajax.reload(function(){promptMSG("success-update","Machine",null,"",!1,!0),dtCompany.dtInstance.ajax.reload(null,!1)},!1)},error:function(t,e){alert(t+e)},complete:function(){t.button("reset")}})},addButton:function(t){var e=$('<a class="btn btn-primary btn-flat btn-sm dt-button-machineadd" href="#" data-target="#modalFormMachine" style="margin-right:0.5em; margin-bottom:0.5em" data-toggle="modal"><span>Add New Machine</span></a>').insertBefore(".dt-button-machinesearch");return $(e).on("click",function(){$(autoDrpDown.cacheOptCompInst).val(t).trigger("chosen:updated"),$(autoDrpDown.cacheOptCompInst).prop("disabled",!0).trigger("chosen:updated"),$("#displayFormMachine").find(".modal-title").text("Add New Machine"),$("#txtBranch").val(0).trigger("chosen:updated"),$("#btnSubmit").text("Save")}),this},add:function(){var t=$("button[type='submit']"),e={action:"add",company_id:$("#slctCompany").chosen().val(),serialnum:$("#txtSerialNum").val(),brand:$("#slctBrands option:selected").val(),model:$("#txtModel").val(),category:$("#slctCategory option:selected").val(),type:$("#slctType option:selected").val(),pagecount:$("#txtPageCount").val(),location:$("#txtLocation").val(),department:$("#txtDepartment").val(),nouser:$("#txtNoUser").val(),remarks:$("#txtRemarks").val(),dateinstall:$("#txtDateInstall").val(),billing:$("#slctBilling option:selected").val(),branch:$("#txtBranch").chosen().val(),unit_own:$("#txtUnitOwn").val(),user_id:Cookies.get("user_id")};$.ajax({type:"POST",url:assets+"php/machine/machine.php",data:e,dataType:"json",beforeSend:function(){$(".dt-head-machinesearch input[type='text'], .dt-head-machinesearch select").val(""),t.button("loading")},success:function(t,e,a){self.dtMachine.dtMInstance.ajax.reload(function(){promptMSG("success-add","Machine",null,"",!1,!0),dtCompany.dtInstance.ajax.reload(null,!1)},!1).page("last")},error:function(t,e){alert(t+e)},complete:function(){t.button("reset"),$("#frmMachine input ,#frmMachine select:not('#slctCompany')").val(""),$("#txtBranch").val(0).trigger("chosen:updated")}})},showRemove:function(t){var e=t;$("#displayRemoveMachine").load(pages+"archive/remove-machine.html",function(t){$("#modalRemoveMachine").modal("show"),$("#modalRemoveMachine .modal-title").attr("data-remove-opt","1"),$("#removehdnId").val(e),autoDrpDown.getMachineStatus("#slctMachineStatus")})},remove:function(t){var e=$("button[type='submit']"),a={action:"remove",id:$("#removehdnId").val(),reason:$("#txtReason").val(),status:$("#slctMachineStatus option:selected").val(),status_action:$("#slctMachineStatus option:selected").data("action"),user_id:Cookies.get("user_id")};$.ajax({type:"POST",url:assets+"php/archive/machine.php",data:a,dataType:"json",beforeSend:function(){e.button("loading")},success:function(t,e,a){self.dtMachine.dtMInstance.ajax.reload(function(){promptMSG("remove","Machine",null,null,!1),dtCompany.dtInstance.ajax.reload(null,!1),$(".mif-modalPromptMSG").on("click","button",function(){$("#modalRemoveMachine").modal("hide")})},!0)},error:function(t,e){alert(t+e)},complete:function(){resetForm("#frmRemoveMachine"),e.button("reset")}})},actions:function(){return $("#dtMachine tbody").on("click","button,a",function(t){t.preventDefault();var e=$(this);if(e.closest("tr").hasClass("selected")||(self.dtMachine.dtMInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected")),$(this).hasClass("btnViewUpdateMachine")){var a=e.data("machine");self.dtMachine.getData(a),$("#btnSubmit").text("Update")}if($(e[0]).hasClass("btnRemoveMachine")){var n=$(this).data("machine");self.dtMachine.showRemove(n)}}),this}},dtFilterMachine={dtFInstance:null,dtRenderDom:null,showModal:function(t){return $(".filter-machine").click(function(e){e.preventDefault(),$("#displayFilterMachine").load(pages+"company/filter-machine.html",function(e,a,n){if($("#modalFilterMachine").modal("show"),"success"==a){var s=convertArrStrToInt(Cookies.get("location"))||[1],l="1"!=Cookies.get("location");autoDrpDown.getBrandName("#fltr-slctbrand"),autoDrpDown.getAllCompany("#fltr-slctcompany","150px"),autoDrpDown.getBranchNameOne("#fltr-slctlocation","120px",s,l),self.dtFilterMachine.autoComplete().showFormMachine().actions(),$("#fltr-slctcompany, #fltr-slctlocation").val(0).trigger("chosen:updated"),$(this).find("#btnFilterSearch").click(function(e){e.preventDefault(),$.fn.DataTable.isDataTable("#dtFilterMachine")&&$(this).find("#dtFilterMachine").DataTable().destroy(),$(this).find("#dtFilterMachine tbody").empty(),self.dtFilterMachine.render(t)})}else alert(n.status+"File not found.")})}),this},autoComplete:function(){return $("#fltr-serialnum").autocomplete({dropdownWidth:"auto",appendMethod:"replace",source:[function(t,e){return""!=t&&$.getJSON("assets/php/misc/serialnumberlist.php?serialnumber="+encodeURIComponent(t),function(t){e(t)}),null}]}),$("#fltr-model").autocomplete({dropdownWidth:"auto",appendMethod:"replace",style:{display:"inline"},source:[function(t,e){return""!=t&&$.getJSON("assets/php/misc/models.php?model="+encodeURIComponent(t),function(t){e(t)}),null}]}),this},render:function(t){var e=$("button#btnFilterSearch");return this.dtFInstance=$("#dtFilterMachine").DataTable({dom:"lBtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sProcessing:"Loading...",sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>'},destroy:!0,sPaginationType:"full_numbers",buttons:[{extend:"excel",className:"dt-searchSN-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,14,15]},filename:"MIF "+getTodayDate()}],ordering:!1,ajax:{url:assets+"php/machine/getMachineListByCompany.php",data:function(e){e.serialnumber=$("#fltr-serialnum").val(),e.brand=$("#fltr-slctbrand option:selected").val()||null,e.model=$("#fltr-model").val(),e.category=$("#fltr-slctcategory option:selected").val()||"",e.type=$("#fltr-slcttype option:selected").val()||"",e.company=$("#fltr-slctcompany").chosen().val()||null,e.branch=$("#fltr-slctlocation").chosen().val()||null,e.user_id=Cookies.get("user_id"),e.department=t,e.billing=$("#fltr-slctBillingType option:selected").val()||null},type:"GET",beforeSend:function(){e.button("loading")},complete:function(){e.button("reset")}},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,title:"Company name",render:function(t,e,a,n){return"<span class='text-center'>"+isEmpty(t.company_name)+"</span>"}},{data:null,title:"S/N",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.serialnumber)+"</span>"}},{data:null,title:"Brand",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.brand_name)+"</span>"}},{data:null,title:"Model",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.model)+"</span>"}},{data:null,title:"Toner",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.toner)+"</span>"}},{data:null,title:"Category",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.category)+"</span>"}},{data:null,title:"Type",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.type)+"</span>"}},{data:null,title:"Page Count",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.page_count)+"</span>"}},{data:null,title:"Location Area",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.location_area)+"</span>"}},{data:null,title:"Department",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.department)+"</span>"}},{data:null,title:"No. of User",render:function(t,e,a,n){return"<span class='text-left'>"+t.no_of_user+"</span>"}},{data:null,title:"Remarks",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.remarks)+"</span>"}},{data:null,title:"Date Installed",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.date_installed)+"</span>"}},{data:null,title:"Unit Owned",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.unit_owned_by)+"</span>"}},{data:null,title:"Billing Type",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.billing_type)+"</span>"}},{data:null,title:"Location",render:function(t,e,a,n){return"<span class='text-left'>"+isEmpty(t.branches)+"</span>"}},{data:null,title:"",render:function(t,e,a,n){return"<button class='btn btn-xs btn-success btn-flat btnViewUpdateMachine' data-target='#modalFormMachine' data-toggle='modal' data-machine='"+t.id+"'>Update</button>"}},{data:null,title:"",render:function(t,e,a,n){return"<a href='#' class='btn btn-xs btn-warning btn-flat btnRemoveMachine' data-machine='"+t.id+"' title='Remove'><i class='fa fa-trash'></i></a>"}}],deferRender:!0,fnDrawCallback:function(t){var e=JSON.parse(Cookies.get("app_module_action"));return null==e?$(".btnViewUpdateMachine, .btnRemoveMachine").remove():"r"==e.action_mif&&$(".btnViewUpdateMachine, .btnRemoveMachine").remove(),!1},preDrawCallback:function(t){$(".dt-searchSN-print, .dt-searchSN-excel").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-searchSN-print").text("").html("<i class='glyphicon glyphicon-print'></i>"),$(".dt-searchSN-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")}}),this},showFormMachine:function(){return $("#displayFormMachine").load(pages+"machine/modal/form.html",function(){$("#modalFormMachine .modal-title").attr("data-update-opt","2");var t=convertArrStrToInt(Cookies.get("location"))||[1],e="1"!=Cookies.get("location");autoDrpDown.getBranchNameOne("#txtBranch","100%",t,e),autoDrpDown.getAllCompany("#slctCompany","60%"),autoDrpDown.getBrandName("#slctBrands")}),this},getData:function(t){null!=t?($("#displayFormMachine").find(".modal-title").text("Update Machine"),$.ajax({type:"GET",url:assets+"php/machine/machine.php",data:{action:"view_id",idmachine:t},dataType:"json",success:function(t){$.each(t.aaData,function(t,e){$("#hdnId").val(e.id),$("#hdnOldSerial").val(e.serialnumber),$("#txtSerialNum").val(e.serialnumber),$("#slctBrands").val(e.brand),$("#txtModel").val(e.model),$("#slctCategory").val(isUpperCase(e.category)),$("#slctType").val(isUpperCase(e.type)),$("#txtPageCount").val(e.page_count),$("#txtLocation").val(e.location_area),$("#txtDepartment").val(e.department),$("#txtNoUser").val(e.no_of_user),$("#txtRemarks").val(e.remarks),$("#txtDateInstall").val(e.date_installed),$("#txtUnitOwn").val(e.unit_owned_by),$("#slctBilling").val(isUpperCase(e.billing_type)),$("#txtBranch").val(e.branches).trigger("chosen:updated"),$("#slctCompany").val(e.company_id).trigger("chosen:updated")})},error:function(t,e,a){}})):$("#displayFormMachine").find(".modal-title").text("Add New Machine")},update:function(){var t={action:"update",idmachine:$("#hdnId").val(),company_id:$("#slctCompany").chosen().val(),serialnum:$("#txtSerialNum").val(),brand:$("#slctBrands option:selected").val(),model:$("#txtModel").val(),category:$("#slctCategory option:selected").val(),type:$("#slctType option:selected").val(),pagecount:$("#txtPageCount").val(),location:$("#txtLocation").val(),department:$("#txtDepartment").val(),nouser:$("#txtNoUser").val(),remarks:$("#txtRemarks").val(),dateinstall:$("#txtDateInstall").val(),unit_own:$("#txtUnitOwn").val(),billing:$("#slctBilling option:selected").val(),branch:$("#txtBranch").chosen().val(),user_id:Cookies.get("user_id")};$.ajax({type:"POST",url:assets+"php/machine/machine.php",data:t,dataType:"json",success:function(t){0==t.aaData[0].status?promptMSG("custom","Can't update due to company selected is <strong>Blocked!</strong>","<i class='fa fa-warning'></i>",null,!1,!0):self.dtFilterMachine.dtFInstance.ajax.reload(function(){promptMSG("success-update","Machine",null,null,!0,!0),dtCompany.dtInstance.ajax.reload(null,!1),$(".mif-modalPromptMSG").on("click","button",function(){$("#modalRemoveMachine").modal("hide")})},!1)},error:function(t,e){alert(t+e)}})},showRemove:function(t){var e=t;$("#displayRemoveMachine").load(pages+"archive/remove-machine.html",function(t){$("#modalRemoveMachine").modal("show"),$("#modalRemoveMachine .modal-title").attr("data-remove-opt","2"),$("#removehdnId").val(e),autoDrpDown.getMachineStatus("#slctMachineStatus")})},remove:function(t){var e={action:"remove",id:$("#removehdnId").val(),reason:$("#txtReason").val(),status:$("#slctMachineStatus option:selected").val(),status_action:$("#slctMachineStatus option:selected").data("action"),user_id:Cookies.get("user_id")};$.ajax({type:"POST",url:assets+"php/archive/machine.php",data:e,dataType:"json",success:function(t,e,a){self.dtFilterMachine.dtFInstance.ajax.reload(function(){promptMSG("remove","Machine",null,null,!1),dtCompany.dtInstance.ajax.reload(null,!1),$(".mif-modalPromptMSG").on("click","button",function(){$("#modalRemoveMachine").modal("hide")})},!0)},error:function(t,e){alert(t+e)},complete:function(){resetForm("#frmRemoveMachine")}})},actions:function(){return $("#modalFilterMachine").on("shown.bs.modal",function(){$(this).on("click","button,a",function(t){t.preventDefault();var e=$(this).data("machine");if($(this).hasClass("btnViewUpdateMachine"))self.dtFilterMachine.getData(e),$("#btnSubmit").text("Update");else if($(this).hasClass("btnRemoveMachine")){var a=$(this).data("machine");self.dtFilterMachine.showRemove(a)}else $(this).is("#btnFilterReset")&&($("#fltr-serialnum, #fltr-slctbrand, #fltr-model, #fltr-slctcategory, #fltr-slcttype, #fltr-slctBillingType").val(""),$("#fltr-slctcompany, #fltr-slctlocation").val(0).trigger("chosen:updated"),$("#dtFilterMachine").DataTable().destroy(),$("#dtFilterMachine thead, #dtFilterMachine tbody").empty())})}),this}},mifMaps={pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Customer Maps</small>"),this},getCoord:function(){var t;return $.ajax({type:"GET",url:assets+"php/company/getCompanyCoord.php",dataType:"json",async:!1,success:function(e){t=e},error:function(t,e,a){alert("Something went wrong!")}}),t},initMap:function(){for(var t={zoom:6,center:new google.maps.LatLng(11.326683,122.957248),gestureHandling:"greedy",styles:[{featureType:"water",elementType:"all",stylers:[{hue:"#7fc8ed"},{saturation:55},{lightness:-6},{visibility:"on"}]},{featureType:"water",elementType:"labels",stylers:[{hue:"#7fc8ed"},{saturation:55},{lightness:-6},{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{hue:"#83cead"},{saturation:1},{lightness:-15},{visibility:"on"}]},{featureType:"landscape",elementType:"geometry",stylers:[{hue:"#f3f4f4"},{saturation:-84},{lightness:59},{visibility:"on"}]},{featureType:"landscape",elementType:"labels",stylers:[{hue:"#ffffff"},{saturation:-100},{lightness:100},{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{hue:"#ffffff"},{saturation:-100},{lightness:100},{visibility:"on"}]},{featureType:"road",elementType:"labels",stylers:[{hue:"#bbbbbb"},{saturation:-100},{lightness:26},{visibility:"on"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#ffcc00"},{saturation:100},{lightness:-35},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{hue:"#ffcc00"},{saturation:100},{lightness:-22},{visibility:"on"}]},{featureType:"poi.school",elementType:"all",stylers:[{hue:"#d7e4e4"},{saturation:-60},{lightness:23},{visibility:"on"}]}]},e=self.mifMaps.getCoord(),a=new google.maps.Map(document.getElementById("map"),t),n=0;n<e.length;n++){var s=new google.maps.LatLng(e[n].latitude,e[n].longitude);self.mifMaps.addMarker({contentString:e[n].company_name+"</br> No. of MIF: "+e[n].num_of_machines,pos:s,map:a})}return this},addMarker:function(t){if("object"!=typeof t||null==t||Array.isArray(t))throw new Error("Paramater object is missing.");var e={position:t.pos,map:t.map,label:null!=t.lblMarker?t.lblMarker.toString():""},a=new google.maps.Marker(e);return self.mifMaps.infoLocation(t.contentString,a,t.map),this},infoLocation:function(t,e,a){return infowindow=new google.maps.InfoWindow,google.maps.event.addListener(e,"click",function(){infowindow.close(),infowindow.setContent(t),infowindow.open(a,this)}),this}},dtSalesHistory={dtInstance:null,dtRenderedDom:null,render:function(t){return $("#displaySalesHistory").load(pages+"company/sap-sales-history.html",function(){$("#modalSalesHistory").modal("show"),self.dtSalesHistory.dataTable(t).actions()}),this},dataTable:function(t){return this.dtInstance=$("#dtSalesHistory").DataTable({dom:"Blrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},processing:!0,serverSide:!0,bDestroy:!0,ordering:!1,ajax:{url:assets+"php/company/sapSalesHistory.php",type:"POST",dataSrc:"records",data:function(e){delete e.columns,e.sap_code=t,e.company=$("#search-sales-company").val()||"",e.acc_manager=$("#search-sales-acctmngr").val()||"",e.fiscal_year=$("#search-sales-year").val()||"",e.month=$("#search-sales-month").val()||""}},buttons:[{extend:"excel",className:"dt-company-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},filename:"Sales History "+getTodayDate()},{extend:"print",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},className:"dt-machine-print hidden-xs",footer:!0,customize:function(t){var e=$(t.document.body);e.find("h1").remove(),e.prepend("<h4>SAP Sales History</h4>")}},{text:"Open Search Filter",className:"dt-button-machinesearch",action:function(t,e,a,n){$(".dt-headsearch").slideToggle("fast",function(){$(this).is(":visible")?a[0].innerText="Close Search Filter":(a[0].innerText="Open Search Filter",$(".dt-head-headsearch input[type='text'], select").val(""),self.dtSalesHistory.dtInstance.ajax.reload(null,!0))})}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return isEmpty(t.company_name)}},{data:null,render:function(t,e,a,n){return isEmpty(t.acc_manager)}},{data:null,render:function(t,e,a,n){return isEmpty(t.fiscal_year)}},{data:null,render:function(t,e,a,n){return isEmpty(t.month)}},{data:null,render:function(t,e,a,n){return isEmpty(t.doc_num)}},{data:null,render:function(t,e,a,n){return isEmpty(t.doc_date)}},{data:null,render:function(t,e,a,n){return isEmpty(t.baseref)}},{data:null,render:function(t,e,a,n){return isEmpty(t.customer_po)}},{data:null,render:function(t,e,a,n){return isEmpty(t.item_code)}},{data:null,render:function(t,e,a,n){return isEmpty(t.description)}},{data:null,render:function(t,e,a,n){return"<div class='text-center'>"+t.quantity+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-center'>"+isEmpty(t.pricevat)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-right'>"+isEmpty(t.gross)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-right'>"+isEmpty(t.vat)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-right'>"+isEmpty(t.net)+"</div>"}}],columnDefs:[{className:"min-mobile  ",targets:1},{className:"min-mobile text-right",targets:13},{className:"min-mobile",targets:14},{className:"min-mobile text-right",targets:15}],deferRender:!0,preDrawCallback:function(t){$(".dt-company-excel, .dt-button-machinesearch, .dt-machine-print").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-machine-print").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".dt-company-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")},footerCallback:function(t,e,a,n,s){var l=this.api(),o=l.context[0].json.totalSales,r=e.reduce(function(t,e){return intVal(t)+intVal(e.net)},0),c=l.table().footer(),i=$(c).children()[0],d=$(c).children()[1];$(i).find("td:eq(15)").html(formatNumber(toDecimal(r))),$(d).find("td:eq(15)").html(o.total_net)}}),this},actions:function(){return $("table#dtSalesHistory").on("click","button",function(t){t.preventDefault();var e=$(this),a=e.text().toLowerCase();e.closest("tr").hasClass("selected")||(self.dtSalesHistory.dtInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected")),"search"==a?self.dtSalesHistory.dtInstance.ajax.reload(null,!0):"reset"==a&&($(".dt-headsearch input[type='text']").val(""),self.dtSalesHistory.dtInstance.ajax.reload(null,!0))}),this}},dtClientCompany={dtInstance:{},pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Home</small>"),this},render:function(){return this.dtInstance=$("#dtClientCompany").DataTable({dom:'fBl<"FilterMachine col-md-2 col-xs-12">rtip',autoWidth:!1,responsive:!0,pageLength:25,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,ordering:!1,ajax:{url:assets+"php/company/getCompanyList.php",type:"POST",data:function(t){t.user_id=Cookies.get("user_id"),t.action_view="account_manager",t.status=1}},buttons:[{text:'<i class="fa fa-refresh" title="Refresh"></li>',className:"",action:function(t,e,a,n){self.dtClientCompany.dtInstance.ajax.reload(null,!1)}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class=''>"+t.company_name+"</span>"}},{data:null,render:function(t,e,a,n){return null!=t.number_of_machines?"<span class='text-center'>"+t.number_of_machines+"</span>":0}},{data:null,width:"30%",render:function(t,e,a,n){return"<span class='text-center'>"+t.address+"</span>"}},{data:null,render:function(t,e,a,n){return"<div class='text-center dt-column-branches'>"+isEmpty(t.branches)+"</div>"}},{data:null,class:"text-right",render:function(t,e,a,n){return'<button class="btn btn-xs btn-success btn-flat btnSapCode" data-sapcode="'+t.sap_code+'">Sales</button>'}},{data:null,render:function(t,e,a,n){return'<button class="btn btn-xs btn-success btn-flat btnViewPrinter" data-comp="'+t.id+'" data-compname="'+encodeURIComponent(t.company_name)+'" data-status="'+t.status+'" '+(0==t.status?"disabled":"")+'><i class="fa fa-list"></i></button>'}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,target:1}],deferRender:!0,preDrawCallback:function(t){$(".dt-button-search, .dt-company-print").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-company-print").text("").html("<i class='glyphicon glyphicon-print'></i>")},footerCallback:function(t,e,a,n,s){var l=this.api(),o=l.column(2).data(),r=0;$.each(o,function(t,e){null!=e.number_of_machines&&(r+=parseInt(e.number_of_machines))}),$(l.column(2).footer()).html("Total Machine: "+formatNumber(r)+" (Total Client: "+e.length+")").css("font-size","13px")}}),$("div.FilterMachine").html('<a href="#" class="filter-machine"><i class="fa fa-filter"></i>Filter Machine</a>'),this},actions:function(){return $("table#dtClientCompany").on("click","button",function(){var t=$(this);if(t.closest("tr").hasClass("selected")||(self.dtClientCompany.dtInstance.$("tr.selected").removeClass("selected"),t.closest("tr").addClass("selected")),$(t[0]).hasClass("btnViewPrinter")){var e=t.data("comp"),a=(t.data("branch"),decodeURIComponent(t.data("compname")));dtMachine.render(e,a,null,"sales")}else if($(t[0]).hasClass("btnSapCode")){var n=t.data("sapcode");dtSalesHistory.render(n)}}),this}},dtBrand={dtInstance:{},render:function(){return this.dtInstance=$("#dtBrand").DataTable({dom:"flrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,bStateSave:!0,ordering:!1,ajax:{url:assets+"php/settings/brand.php",type:"GET",data:{action:"view-all"}},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+t.brand_name+"</span>"}},{data:null,render:function(t,e,a,n){return 1==t.status?"<span class='text-left'> Active </span>":"<span class='text-left' style='color:#dd4b39'> Inactive </span>"}},{data:null,render:function(t,e,a,n){return"<button class='btn btn-xs btn-success btn-flat btnUpdateBrand' data-brand='"+t.id+"'>Update</button>"}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,width:"20%",target:1}],deferRender:!0,preDrawCallback:function(t){$(".dt-button-addbrand").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"})}}),this},modalShow:function(t){$("#displayFormBrand").load(pages+"settings/form-brand.html",function(e,a,n){$("#modalFormBrand").modal("show"),null!=t?($(this).find(".modal-title").text("Update Brand"),$.ajax({type:"GET",url:assets+"php/settings/brand.php",data:{action:"view",idbrand:t},dataType:"json",success:function(t){$.each(t.aaData,function(t,e){$("#hdnIdBrand").val(e.id),$("#txtSettingsBrand").val(e.brand_name),$("#hdnOldBrand").val(e.brand_name),$("#slctBrandStatus").val(e.status)})},error:function(t,e,a){}})):$(this).find(".modal-title").text("Add Brand")})},update:function(){var t={action:"update",idbrand:$("#hdnIdBrand").val(),brandname:$("#txtSettingsBrand").val(),status:$("#slctBrandStatus option:selected").val()};$.ajax({type:"POST",url:assets+"php/settings/brand.php",data:t,dataType:"json",success:function(t){self.dtBrand.dtInstance.ajax.reload(null,!1),autoDrpDown.cacheOptBrands.splice(0,1)},error:function(t,e,a){console.log(e+a)}})},add:function(){var t={action:"add",brandname:$("#txtSettingsBrand").val(),status:$("#slctBrandStatus option:selected").val()};$.ajax({type:"POST",url:assets+"php/settings/brand.php",data:t,dataType:"json",success:function(t){self.dtBrand.dtInstance.ajax.reload(null,!1).page("last"),autoDrpDown.cacheOptBrands.splice(0,1)},error:function(t,e,a){console.log(e+a)},complete:function(){resetForm("#frmSettingsBrand")}})},actions:function(){return $(".box-brand").on("click","button",function(){var t=$(this);if(t.closest("tr").hasClass("selected")||(self.dtBrand.dtInstance.$("tr.selected").removeClass("selected"),t.closest("tr").addClass("selected")),"Update"==t.text()){var e=$(this).data("brand");self.dtBrand.modalShow(e)}else self.dtBrand.modalShow()}),this}},dtBranch={dtInstance:{},pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Settings</small>"),this},render:function(){return this.dtInstance=$("#dtBranch").DataTable({dom:"flrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,bStateSave:!0,ordering:!1,ajax:{url:assets+"php/misc/locations.php",type:"GET"},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+t.branch_name+"</span>"}},{data:null,render:function(t,e,a,n){return 1==t.status?"<span class='text-left'> Active </span>":"<span class='text-left' style='color:#dd4b39'> Inactive </span>"}},{data:null,render:function(t,e,a,n){return 1!=t.id?"<button class='btn btn-xs btn-success btn-flat btnUpdateBranch' data-branch='"+t.id+"'>Update</button>":""}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,width:"20%",target:1}],deferRender:!0,preDrawCallback:function(t){$(".dt-button-addbranch").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"})}}),this},modalShow:function(t){$("#displayFormBranch").load(pages+"settings/form-branch.html",function(e,a,n){$("#modalFormBranch").modal("show"),null!=t?($(this).find(".modal-title").text("Update Location"),$.ajax({type:"GET",url:assets+"php/settings/location.php",data:{action:"view",idbranch:t},dataType:"json",success:function(t){$.each(t.aaData,function(t,e){$("#hdnId").val(e.id),$("#txtSettingsBranch").val(e.branch_name),$("#hdnOldBranch").val(e.branch_name),$("#slctLocationStatus").val(e.status)})},error:function(t,e,a){}})):$(this).find(".modal-title").text("Add Location")})},update:function(){var t={action:"update",idbranch:$("#hdnId").val(),branchname:$("#txtSettingsBranch").val(),status:$("#slctLocationStatus option:selected").val()};$.ajax({type:"POST",url:assets+"php/settings/location.php",data:t,dataType:"json",success:function(t){self.dtBranch.dtInstance.ajax.reload(null,!1),autoDrpDown.cacheOptBranch.splice(0,1),autoDrpDown.cacheOptBranchOne.splice(0,1)},error:function(t,e,a){alert(e+a)}})},add:function(){var t={action:"add",branchname:$("#txtSettingsBranch").val(),status:$("#slctLocationStatus option:selected").val()};$.ajax({type:"POST",url:assets+"php/settings/location.php",data:t,dataType:"json",success:function(t){self.dtBranch.dtInstance.ajax.reload(null,!1).page("last"),autoDrpDown.cacheOptBranch.splice(0,1),autoDrpDown.cacheOptBranchOne.splice(0,1)},error:function(t,e,a){alert(e+a)},complete:function(){resetForm("#frmSettingsBranch")}})},actions:function(){return $("table#dtBranch").on("click","button",function(){var t=$(this);if(t.closest("tr").hasClass("selected")||(self.dtBranch.dtInstance.$("tr.selected").removeClass("selected"),t.closest("tr").addClass("selected")),"Update"==t.text()){var e=$(this).data("branch");self.dtBranch.modalShow(e)}}),$("#addBranch").click(function(t){self.dtBranch.modalShow()}),this}},dtStatus={dtInstance:{},render:function(){return this.dtInstance=$("#dtStatus").DataTable({dom:"flrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,bStateSave:!0,ordering:!1,ajax:{url:assets+"php/misc/machinestatus.php",type:"GET"},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+t.status_name+"</span>"}},{data:null,render:function(t,e,a,n){return"<button class='btn btn-xs btn-success btn-flat btnUpdateStatus' data-status='"+t.id+"'>Update</button>"}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,width:"20%",target:1}],deferRender:!0,preDrawCallback:function(t){$(".dt-button-addStatus").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"})}}),this},modalShow:function(t){$("#displayFormStatus").load(pages+"settings/form-machine-status.html",function(e,a,n){$("#modalFormStatus").modal("show"),null!=t?($(this).find(".modal-title").text("Update Status"),$.ajax({type:"GET",url:assets+"php/settings/machineStatus.php",data:{action:"view-id",id:t},dataType:"json",success:function(t){$.each(t.aaData,function(t,e){$("#hdnIdStatus").val(e.id),$("#txtSettingStatus").val(e.status_name),$("#hdnOldStatus").val(e.status_name),$("input[name='optradioStatus'][value="+e.set_default+"]").prop("checked",!0)})},error:function(t,e,a){}})):$(this).find(".modal-title").text("Add Status")})},update:function(){var t={action:"update",id:$("#hdnIdStatus").val(),status_name:$("#txtSettingStatus").val(),status_action:$("input[name='optradioStatus']:checked").val()};$.ajax({type:"POST",url:assets+"php/settings/machineStatus.php",data:t,dataType:"json",success:function(t){self.dtStatus.dtInstance.ajax.reload(null,!1),autoDrpDown.cacheOptRemoveMachine.splice(0,1)},error:function(t,e,a){console.log(e+a)}})},add:function(){var t={action:"add",status_name:$("#txtSettingStatus").val(),status_action:$("input[name='optradioStatus']:checked").val()};$.ajax({type:"POST",url:assets+"php/settings/machineStatus.php",data:t,dataType:"json",success:function(t){self.dtStatus.dtInstance.ajax.reload(null,!1),autoDrpDown.cacheOptRemoveMachine.splice(0,1)},error:function(t,e,a){resetForm("#frmSettingStatus")}})},actions:function(){return $("table#dtStatus").on("click","button",function(t){var e=$(this);if(e.closest("tr").hasClass("selected")||(self.dtStatus.dtInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected")),$(e[0]).hasClass("btnUpdateStatus")){var a=$(this).data("status");self.dtStatus.modalShow(a)}}),$("#addStatus").click(function(t){self.dtStatus.modalShow()}),this}},dtSapCustomer={dtInstance:{},render:function(){return this.dtInstance=$("#dtSapCustomer").DataTable({dom:"flrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,ordering:!1,ajax:{url:assets+"php/settings/sap_master_details.php",type:"GET",data:{action:"view-all"}},columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+(t.sap_code||"---")+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+(t.company_name||"---")+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+(t.location||"---")+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-center'>"+(t.address||"---")+"</span>"}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,width:"20%",target:1}],deferRender:!0}),this}},dtAccounts={dtInstance:{},dtInstanceLogs:null,pageDetails:function(){return $(".content-header h1").text("Accounts"),$(".content-header h1").append("<small>Company</small>"),this},render:function(){return this.dtInstance=$("#dtAccount").DataTable({dom:"fBlrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,ordering:!1,ajax:{url:assets+"php/accounts/company.php",type:"GET",data:{action:"view-all"}},buttons:[{text:"Add New Account",className:"dt-button-addaccount",action:function(t,e,a,n){self.dtAccounts.modalShow()}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.username+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.firstname+" "+t.middlename+" "+t.lastname+"</span>"}},{data:null,render:function(t,e,a,n){return"<div class='text-left dt-column-branches'>"+t.location+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-left'>"+t.branch+"</div>"}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.accountrole+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.created_at+"</span>"}},{data:null,render:function(t,e,a,n){return"<button class='btn btn-xs btn-success btn-flat btnUpdateAcc' data-acc='"+t.id+"'>Update</button>"}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,width:"20%",target:1}],deferRender:!0,fnCreatedRow:function(t,e){$("td:eq(0)",t).attr("data-id-account",e.id)},preDrawCallback:function(t){$(".dt-button-addaccount").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"})}}),this},modalShow:function(t){$("#displayFormAccount").load(pages+"accounts/form.html",function(e,a,n){$("#modalFormAccount").modal("show"),autoDrpDown.getBranchNameMulti("#slctAccountLocation","100%",0,!1),autoDrpDownInvnt.getBranch("#slctAccountBranch"),autoDrpDownInvnt.getBranch("#slctAccountBranchMrf"),autoDrpDownInvnt.getBranch("#slctAccountBranchPm",null,[1]),autoDrpDownMrf.getAccountDept("#slctAccountDept"),$("input[name='radioMifActions']").click(function(t){var e=$("#slctAccountDept option:selected").attr("data-group-mif");"r"==$(this).val()?"view"==e&&$("#slctAccountLocation").val(1).prop("disabled",!0).trigger("chosen:updated"):$("#slctAccountLocation").val(0).prop("disabled",!1).trigger("chosen:updated")}),$("#slctAccountDept").change(function(t){var e=$(":selected",this),a=[2,3],n=parseInt(e.val());"view"==e.attr("data-group-mif")?($("#slctAccountLocation").val(1).prop("disabled",!0).trigger("chosen:updated"),$("#chkAppMif").is(":checked")&&$("input[name='radioMifActions'][value='r']").prop("checked",!0),a.indexOf(n)>-1&&$("input[name='radioMifActions']").prop("disabled",!0)):($("#slctAccountLocation").val(0).prop("disabled",!1).trigger("chosen:updated"),-1==a.indexOf(n)&&$("input[name='radioMifActions']").prop("disabled",!1)),"approver"==e.attr("data-group")?($("#slctAccountBranchMrf option[value=1]").show(),$("#slctAccountBranchMrf").val(1).prop("disabled",!0)):($("#slctAccountBranchMrf option").filter(function(t){return t<=1}).hide(),$("#slctAccountBranchMrf").val("").prop("disabled",!1))}),$("#slctPmType").change(function(t){"MONITOR"==$(":selected",this).val()?($("#slctAccountBranchPm option[value=1]").show(),$("input[name='radioPmActions'][value='r']").prop("checked",!0),$("input[name='radioPmActions'][value='wr']").prop("disabled",!0)):($("#slctAccountBranchPm option[value=1]").hide(),$("#slctAccountBranchPm").val(""),$("input[name='radioPmActions'][value='wr']").prop("disabled",!1))}),null!=t?($(this).find(".modal-title").text("Update Account"),$.ajax({type:"GET",url:assets+"php/accounts/company.php",data:{action:"view-id",idaccount:t},dataType:"json",success:function(t){$.each(t.aaData,function(t,e){var a=parseInt(e.app_mif)||null,n=parseInt(e.app_pm)||null,s=parseInt(e.app_inventory)||null,l=parseInt(e.app_mrf)||null;$("#hdnIdAccount").val(e.id),$("#hdnOldUsername").val(e.username),$("#txtUsername").val(e.username),$("#txtFname").val(e.firstname),$("#txtMname").val(e.middlename),$("#txtLname").val(e.lastname),$("#txtEmail").val(e.email),$("#slctStatus").val(e.status),$("#slctAccountRole").val(e.accountrole),$("#slctPmType").val(e.pm_type),$("#txtDateCreated").text(e.created_at),$("#chkAppMif").prop("checked",null!=a),$("#chkAppPm").prop("checked",null!=n),$("#chkAppInventory").prop("checked",null!=s),$("#chkAppMrf").prop("checked",null!=l),$("#slctAccountLocation").prop("disabled",null==a),$("#slctAccountDept").val(e.account_type).trigger("change"),$("#slctAccountLocation").val(null==e.location?null:e.location.split(",")).trigger("chosen:updated"),$("#slctAccountBranch").val(e.branch).prop("disabled",null==s),$("#slctAccountBranchPm").val(e.branch_pm).prop("disabled",null==n),$("#slctAccountBranchMrf").val(e.branch_mrf).prop("disabled",!(null!=l&&l>0&&e.account_type>1)),""!=e.action_mif&&$("input[name='radioMifActions'][value="+e.action_mif+"]").prop("checked",!0),""!=e.action_invnt&&$("input[name='radioInvntActions'][value="+e.action_invnt+"]").prop("checked",!0),""!=e.action_mrf&&$("input[name='radioMrfActions'][value="+e.action_mrf+"]").prop("checked",!0),""!=e.action_pm&&$("input[name='radioPmActions'][value="+e.action_pm+"]").prop("checked",!0)})},error:function(t,e,a){alert("Something went wrong.")}})):($(this).find(".modal-title").text("Add Account"),$("#slctAccountLocation").val(0).trigger("chosen:updated"),$("#txtDateCreated").text(getTodayDate()))})},update:function(){var t=$("button[type='submit']"),e=$("#hdnIdAccount").val(),a=$("#txtUsername").val(),n=$("#txtPassword").val(),s=$("#txtFname").val(),l=$("#txtMname").val(),o=$("#txtLname").val(),r=$("#txtEmail").val(),c=$("#slctAccountRole option:selected").val(),i=$("#slctPmType option:selected").val(),d=$("#slctStatus option:selected").val(),p=$("input[name='chkAppMif']:checked").val()||"",u=$("input[name='chkAppPm']:checked").val()||"",m=$("#slctAccountLocation").chosen().val()?$("#slctAccountLocation").chosen().val().toString():"",h=$("input[name='chkAppInventory']:checked").val()||"",f=$("#slctAccountBranch option:selected").val(),v=$("#slctAccountBranchPm option:selected").val(),g=$("input[name='chkAppMrf']:checked").val()||"",y=$("#slctAccountBranchMrf option:selected").val(),b=$("#slctAccountDept option:selected").val(),x=$("input[name='radioMifActions']:checked").val(),C=$("input[name='radioPmActions']:checked").val(),_=$("input[name='radioInvntActions']:checked").val(),w=$("input[name='radioMrfActions']:checked").val(),S={action:"update",idaccount:e,username:a,pass:n,fname:s,mname:l,lname:o,email:r,app_mif:p,app_pm:u,action_pm:C,location:m,app_invt:h,branch:f,branch_pm:v,app_mrf:g,branch_mrf:y,accrole:c,status:d,acc_type_mrf:b,action_mif:x,action_invnt:_,action_mrf:w,pm_type:i};$.ajax({type:"POST",url:assets+"php/accounts/company.php",data:S,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t){1==t.aaData.check_location?promptMSG("custom","Can't update due the <strong>ALL</strong> location can't combined.","<i class='fa fa-warning'></i>",null,!1,!0):self.dtAccounts.dtInstance.ajax.reload(function(){promptMSG("success-update","Company Account",null,"",!1,!0);var t=Cookies.get("user_id");e==t&&(Cookies.clear("location"),Cookies.set("location",m,.5))},!1)},error:function(t,e){alert("Something went wrong.")},complete:function(){t.button("reset")}})},add:function(){var t=$("button[type='submit']"),e={action:"add",username:$("#txtUsername").val(),pass:$("#txtPassword").val(),fname:$("#txtFname").val(),mname:$("#txtMname").val(),lname:$("#txtLname").val(),email:$("#txtEmail").val(),app_mif:$("input[name='chkAppMif']:checked").val()||"",location:$("#slctAccountLocation").chosen().val()?$("#slctAccountLocation").chosen().val().toString():"",app_invt:$("input[name='chkAppInventory']:checked").val()||"",branch:$("#slctAccountBranch option:selected").val(),app_mrf:$("input[name='chkAppMrf']:checked").val()||"",branch_mrf:$("#slctAccountBranchMrf option:selected").val(),accrole:$("#slctAccountRole option:selected").val(),status:$("#slctStatus option:selected").val(),acc_type_mrf:$("#slctAccountDept option:selected").val(),action_mif:$("input[name='radioMifActions']:checked").val(),action_invnt:$("input[name='radioInvntActions']:checked").val(),action_mrf:$("input[name='radioMrfActions']:checked").val(),pm_type:$("#slctPmType option:selected").val(),action_pm:$("input[name='radioPmActions']:checked").val(),branch_pm:$("#slctAccountBranchPm option:selected").val(),app_pm:$("input[name='chkAppPm']:checked").val()||""},a=!1;$.ajax({type:"POST",url:assets+"php/accounts/company.php",data:e,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t,e,n){1==t.aaData.check_location?promptMSG("custom","Can't add due the <strong>ALL</strong> location can't combined.","<i class='fa fa-warning'></i>",null,!1,!0):(self.dtAccounts.dtInstance.ajax.reload(function(){promptMSG("success-add","Company Account",null,"",!1,!0)},!1).page("last"),a=!0)},error:function(t,e){alert("Something went wrong.")},complete:function(){a&&resetForm("#frmAccount"),t.button("reset")}})},actions:function(){return $("table#dtAccount").on("click","button",function(){var t=$(this);if(t.closest("tr").hasClass("selected")||(self.dtAccounts.dtInstance.$("tr.selected").removeClass("selected"),t.closest("tr").addClass("selected")),"Update"==t.text()){var e=$(this).data("acc");self.dtAccounts.modalShow(e)}}),this},login_logs:function(){return this.dtInstanceLogs=$("#dtAccLoginLogs").DataTable({dom:"<'search-toolbar'>lrtip",processing:!0,serverSide:!0,ordering:!1,destroy:!0,responsive:!1,ajax:{url:assets+"php/accounts/accountLoginLogs.php",type:"POST",dataSrc:"records",data:function(t){t.search={value:$("#txtSearchLogs").val()||null}}},columns:[{data:null},{data:"fullname"},{data:"date_log"},{data:"description"},{data:"ip_address"}],columnDefs:[{targets:0,render:function(t,e,a,n){return n.row+1}}]}),$("div.search-toolbar").html("<div class='pull-right'><input type='search' id='txtSearchLogs' placeholder='Search' style='margin-right:10px'/><a href='#' class='btn btn-flat btn-xs btn-primary' id='btnSearchLogs'><i class='fa fa-search' title='Search'></i></a></div>"),$("#btnSearchLogs").click(function(t){t.preventDefault(),self.dtAccounts.dtInstanceLogs.ajax.reload()}),this},changePassword:function(t){var e=$("button[type='submit']"),a=$("#txtConfirmPassword").val(),n=t;return $.ajax({type:"POST",url:assets+"php/accounts/company.php",data:{action:"change_password",idaccount:n,pass:a},dataType:"json",beforeSend:function(){e.button("loading")},success:function(t){"success"==t.status?promptMSG("success-update","Password",null,"",!1,!0):alert("Error, missing data paramaters.")},error:function(t,e){alert("Something went wrong.")},complete:function(){e.button("reset")}}),this}},dtAccClient={dtInstance:{},dtInstanceLogs:null,pageDetails:function(){return $(".content-header h1").text("Accounts"),$(".content-header h1").append("<small>Manager</small>"),this},render:function(){return this.dtInstance=$("#dtClient").DataTable({dom:"fBlrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{bProcessing:!0,sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},bDestroy:!0,ordering:!1,ajax:{url:assets+"php/accounts/manager/manager.php",type:"POST",data:{action:"view-all"}},buttons:[{text:"Add New Manager",className:"dt-button-addaccount",action:function(t,e,a,n){self.dtAccClient.modalShow()}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.fullname+"</span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.company+"</span>"}},{data:null,render:function(t,e,a,n){return 1==t.status?"<span class='text-left'> Active </span>":"<span class='text-left' style='color:#dd4b39'> Inactive </span>"}},{data:null,render:function(t,e,a,n){return"<span class='text-left'>"+t.created_at+"</span>"}},{data:null,render:function(t,e,a,n){return"<button class='btn btn-xs btn-success btn-flat btnUpdateAcc' data-acc-client='"+t.id+"'>Update</button>"}}],columnDefs:[{responsivePriority:1,target:0},{responsivePriority:2,width:"20%",target:1},{targets:2,className:"none"}],deferRender:!0,fnCreatedRow:function(t,e){$("td:eq(0)",t).attr("data-id-account",e.id)},preDrawCallback:function(t){$(".dt-button-addaccount").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"})}}),this},modalShow:function(t){$("#displayFormAccClient").load(pages+"accounts/form-client.html",function(e,a,n){autoDrpDown.getAllCompany("#slctClientCompany","100%"),autoDrpDown.getAssignAccountManager("#slctAcctMngrName"),$("#modalFormAccClient").modal("show"),null!=t?($(this).find(".modal-title").text("Update Manager"),$.ajax({type:"GET",url:assets+"php/accounts/manager/manager.php",data:{action:"view-id",idclient:t},dataType:"json",success:function(t){$.each(t.aaData,function(t,e){$("#hdnClientId").val(e.id),$("#hdnOldSlctAcctMngrName").val(e.account_id),$("#slctAcctMngrName").val(e.account_id).trigger("chosen:updated"),$("#txtClientDateCreated").text(e.created_at),$("#hdnClientOldCompany").val(e.company),$("#slctClientCompany").val(e.company.split(",")).trigger("chosen:updated"),$("#txtIDemp").val(e.idemp)})},error:function(t,e,a){}})):($(this).find(".modal-title").text("Add Manager"),$("#txtClientDateCreated").text(getTodayDate()))})},update:function(){var t=$("button[type='submit']"),e=$("#hdnClientId").val(),a=$("#slctAcctMngrName").chosen().val()?$("#slctAcctMngrName").chosen().val():null,n=$("#slctClientCompany").chosen().val()?$("#slctClientCompany").chosen().val().toString():"",s=$("#hdnClientOldCompany").val(),l=$("#hdnOldSlctAcctMngrName").val(),o=$("#txtIDemp").val(),r={action:"update",idclient:e,account_id:a,companies:n,old_companies:s,old_account_id:l,id_emp:o};$.ajax({type:"POST",url:assets+"php/accounts/manager/manager.php",data:r,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t){return 1==t.aaData.has_value_accmngr?(promptMSG("custom","<strong>Company already taken: </strong><span style='color:#d24d3c'>"+t.aaData.exist_company+"</span>","<i class='fa fa-warning'></i>"),!1):"true"==t.aaData.isNameExist?(promptMSG("warning","Name is already exist.",null,"",!1,!0),!1):($("#hdnClientOldCompany").val(n),$("#hdnOldSlctAcctMngrName").val(a),void self.dtAccClient.dtInstance.ajax.reload(function(){promptMSG("success-update","Account Manager",null,"",!1,!0),autoDrpDown.cacheOptClient.splice(0,1)},!1))},error:function(t,e){alert(t+e)},complete:function(){t.button("reset")}})},add:function(){var t=$("button[type='submit']"),e={action:"add",account_id:$("#slctAcctMngrName").chosen().val()?$("#slctAcctMngrName").chosen().val():null,companies:$("#slctClientCompany").chosen().val()?$("#slctClientCompany").chosen().val().toString():"",id_emp:$("#txtIDemp").val()};return $.ajax({type:"POST",url:assets+"php/accounts/manager/manager.php",data:e,dataType:"json",beforeSend:function(){t.button("loading")},success:function(t,e,a){return 1==t.aaData.has_value_accmngr?(promptMSG("custom","<strong>Company already taken: </strong><span style='color:#d24d3c'>"+t.aaData.exist_company+"</span>","<i class='fa fa-warning'></i>"),!1):"true"==t.aaData.isNameExist?(promptMSG("warning","Name is already exist.",null,"",!1,!0),!1):(self.dtAccClient.dtInstance.ajax.reload(function(){promptMSG("success-add","Account Manager",null,"",!1,!0),autoDrpDown.cacheOptClient.splice(0,1)},!1).page("last"),void resetForm("#frmAccountClient"))},error:function(t,e,a){alert(t+e+a.text)},complete:function(){t.button("reset")}}),this},actions:function(){return $("table#dtClient").on("click","button",function(){var t=$(this);if(t.closest("tr").hasClass("selected")||(self.dtAccClient.dtInstance.$("tr.selected").removeClass("selected"),t.closest("tr").addClass("selected")),"Update"==t.text()){var e=$(this).data("acc-client");self.dtAccClient.modalShow(e)}}),this},login_logs:function(){return this.dtInstanceLogs=$("#dtAccMngrLoginLogs").DataTable({dom:"<'search-toolbar'>lrtip",processing:!0,serverSide:!0,ordering:!1,destroy:!0,responsive:!1,ajax:{url:assets+"php/accounts/manager/accountMngrLoginLogs.php",type:"POST",dataSrc:"records",data:function(t){t.search={value:$("#txtSearchLogs").val()||null}}},columns:[{data:null},{data:"fullname"},{data:"date_log"},{data:"description"},{data:"ip_address"}],columnDefs:[{targets:0,render:function(t,e,a,n){return n.row+1}}]}),$("div.search-toolbar").html("<div class='pull-right'><input type='search' id='txtSearchLogs' placeholder='Search' style='margin-right:10px'/><a href='#' class='btn btn-flat btn-xs btn-primary' id='btnSearchLogs'><i class='fa fa-search' title='Search'></i></a></div>"),$("#btnSearchLogs").click(function(t){t.preventDefault(),self.dtAccClient.dtInstanceLogs.ajax.reload()}),this}},reportSalesDetails={dtInstance:null,pageDetails:function(){return $(".content-header h1").text("Machine in Field"),$(".content-header h1").append("<small>Reports</small>"),this},dataTable:function(t){t=Cookies.get("user_id");return this.dtInstance=$("#dtSalesDetails").DataTable({dom:"Blrtip",autoWidth:!1,responsive:!0,pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],oLanguage:{sLoadingRecords:'<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i><span class="sr-only">Please wait - loading...</span>',sInfoEmpty:"No entries to show"},processing:!0,serverSide:!0,bDestroy:!0,ordering:!1,ajax:{url:assets+"php/company/sapSalesDetails.php",type:"POST",dataSrc:"records",data:function(e){delete e.columns,e.user_id=t,e.company=$(".search-company").val()||"",e.fiscal_year=$(".search-year").val()||"",e.month=$(".search-month").val()||""}},buttons:[{extend:"excel",className:"dt-company-excel hidden-xs",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},filename:"Sales History "+getTodayDate()},{extend:"print",exportOptions:{columns:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]},className:"dt-machine-print hidden-xs",footer:!0,customize:function(t){var e=$(t.document.body);e.find("h1").remove(),e.prepend("<h4>SAP Sales History</h4>")}},{text:"Open Search Filter",className:"dt-button-machinesearch",action:function(t,e,a,n){$(".dt-headsearch").slideToggle("fast",function(){$(this).is(":visible")?a[0].innerText="Close Search Filter":(a[0].innerText="Open Search Filter",$(".dt-head-headsearch input[type='text'], select").val(""),self.reportSalesDetails.dtInstance.ajax.reload(null,!0))})}}],columns:[{data:null,render:function(t,e,a,n){return n.row+1}},{data:null,render:function(t,e,a,n){return isEmpty(t.company_name)}},{data:null,render:function(t,e,a,n){return isEmpty(t.acc_manager)}},{data:null,render:function(t,e,a,n){return isEmpty(t.fiscal_year)}},{data:null,render:function(t,e,a,n){return isEmpty(t.month)}},{data:null,render:function(t,e,a,n){return isEmpty(t.doc_num)}},{data:null,render:function(t,e,a,n){return isEmpty(t.doc_date)}},{data:null,render:function(t,e,a,n){return isEmpty(t.baseref)}},{data:null,render:function(t,e,a,n){return isEmpty(t.customer_po)}},{data:null,render:function(t,e,a,n){return isEmpty(t.item_code)}},{data:null,render:function(t,e,a,n){return isEmpty(t.description)}},{data:null,render:function(t,e,a,n){return"<div class='text-center'>"+t.quantity+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-center'>"+isEmpty(t.pricevat)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-right'>"+isEmpty(t.gross)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-right'>"+isEmpty(t.vat)+"</div>"}},{data:null,render:function(t,e,a,n){return"<div class='text-right'>"+isEmpty(t.net)+"</div>"}}],columnDefs:[{className:"min-mobile  ",targets:1},{className:"min-mobile text-right",targets:13},{className:"min-mobile",targets:14},{className:"min-mobile text-right",targets:15}],deferRender:!0,preDrawCallback:function(t){$(".dt-company-excel, .dt-button-machinesearch, .dt-machine-print").removeClass("dt-button").addClass("btn btn-primary btn-flat btn-sm").css({"margin-bottom":"0.5em","margin-right":"0.5em"}),$(".dt-machine-print").text("").html("<i class='glyphicon glyphicon-print'></i>").attr("title","Print"),$(".dt-company-excel").text("").html("<i class='fa fa-file-excel-o'></i>").attr("title","Export to Excel")},footerCallback:function(t,e,a,n,s){var l=this.api(),o=l.context[0].json.totalSales,r=e.reduce(function(t,e){return intVal(t)+intVal(e.net)},0),c=l.table().footer(),i=$(c).children()[0],d=$(c).children()[1];$(i).find("td:eq(15)").html(formatNumber(toDecimal(r))),$(d).find("td:eq(15)").html(o.total_net)}}),this},actions:function(){return $("table#dtSalesDetails").on("click","button",function(t){t.preventDefault();var e=$(this),a=e.text().toLowerCase();e.closest("tr").hasClass("selected")||(self.reportSalesDetails.dtInstance.$("tr.selected").removeClass("selected"),e.closest("tr").addClass("selected")),"search"==a?self.reportSalesDetails.dtInstance.ajax.reload(null,!0):"reset"==a&&($(".dt-headsearch input[type='text']").val(""),self.reportSalesDetails.dtInstance.ajax.reload(null,!0))}),this}},reportSalesPerAccount={pageDetails:function(){return $(".content-header h1").text("Sales"),$(".content-header h1").append("<small>Report</small>"),self.reportSalesPerAccount.drop_down_sales(),this},drop_down_sales:function(){autoDrpDown.getlistYear("#select-year-sales"),autoDrpDown.getlistYear("#select-yearly-sales"),$("#select-month-sales, #select-year-sales").on("change",function(){self.reportSalesPerAccount.table_montly_sales()}),$("#select-yearly-sales").on("change",function(){self.reportSalesPerAccount.table_yearly_sales()})},table_montly_sales:function(){var t="",e=$("#select-month-sales option:selected").val(),a=$("#select-year-sales option:selected").val();return $.ajax({type:"GET",url:assets+"php/company/sapSalesSummary.php",cache:!1,data:{action:"month",month:e,year:a},dataType:"json",success:function(e,a,n){0!=e.length?$.each(e,function(e,a){t+="<tr>",t+="<td>"+a.acc_manager+"</td>",t+="<td>"+a.t_gross+"</td>",t+="<td>"+a.t_vat+"</td>",t+="<td>"+a.t_net+"</td>",t+="</tr>"}):t="<tr><td colspan='4'><h5 class='text-center'>No data available in the table</h5></td></tr>"},complete:function(e){$("#reportMonthlySales > tbody").html(t)}}),this},table_yearly_sales:function(){var t="",e=$("#select-yearly-sales option:selected").val();return $.ajax({type:"GET",url:assets+"php/company/sapSalesSummary.php",cache:!1,data:{action:"year",year:e},dataType:"json",success:function(e,a,n){0!=e.length?$.each(e,function(e,a){t+="<tr>",t+="<td>"+a.acc_manager+"</td>",t+="<td>"+a.t_gross+"</td>",t+="<td>"+a.t_vat+"</td>",t+="<td>"+a.t_net+"</td>",t+="</tr>"}):t="<tr><td colspan='4'><h5 class='text-center'>No data available in the table</h5></td></tr>"},complete:function(e){$("#reportYearlySales > tbody").html(t)}}),this}};